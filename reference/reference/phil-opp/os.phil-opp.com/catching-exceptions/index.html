<!doctype html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="This blog series creates a small operating system in the Rust programming language. Each post is a small tutorial and includes all needed code.">
    <meta name="author" content="Philipp Oppermann">

    <link href="../css/edition-1/poole.css" rel="stylesheet">
    <link href="../css/edition-1/main.css" rel="stylesheet">
    <link href="../css/edition-1/isso.css" rel="stylesheet">

    <script async src="../js/edition-1/main.js"></script>

    <title>Catching Exceptions | Writing an OS in Rust (First Edition)</title>
</head>

<body>
    <div class="container content">
        <header class="masthead">
            <h2 class="masthead-title">
                <a href="../edition-1" title="Home">Writing an OS in Rust (First Edition)</a>
            </h2>
            <p><small>Philipp&nbsp;Oppermann's&nbsp;blog</small></p>
        </header>

        <main>
    <h1>Catching Exceptions</h1>
    <time datetime="2016-05-28" class="post-date">
        May 28, 2016
         (updated on Jun 25, 2016) 
    </time>

    <aside id="toc-aside">
        <h2>Table of Contents</h2>
        <ol>
            <li>
                <a href="index.html#exceptions">Exceptions</a>
                <ol>
                    <li>
                        <a href="index.html#the-interrupt-descriptor-table">The Interrupt Descriptor Table</a>
                    </li>
                </ol>
            </li><li>
                <a href="index.html#handling-exceptions">Handling Exceptions</a>
                <ol>
                    <li>
                        <a href="index.html#entry-options">Entry Options</a>
                    </li><li>
                        <a href="index.html#creating-idt-entries">Creating IDT Entries</a>
                    </li><li>
                        <a href="index.html#the-handler-function-type">The Handler Function Type</a>
                    </li><li>
                        <a href="index.html#idt-methods">IDT methods</a>
                    </li><li>
                        <a href="index.html#loading-the-idt">Loading the IDT</a>
                    </li><li>
                        <a href="index.html#a-static-idt">A static IDT</a>
                    </li>
                </ol>
            </li><li>
                <a href="index.html#testing-it">Testing it</a>
                <ol>
                    <li>
                        <a href="index.html#inline-assembly">Inline Assembly</a>
                    </li>
                </ol>
            </li><li>
                <a href="index.html#what-s-next">What‚Äôs next?</a>
                
            </li>
        </ol>
    </aside>

    <div class="warning">
        <b>No longer updated!</b> You are viewing the a post of the first edition of ‚ÄúWriting an OS in Rust‚Äù, which is no longer updated. You can find the second edition <a href="../edition-2/index.html">here</a>.
    </div>

    <p>In this post, we start exploring exceptions. We set up an interrupt descriptor table and add handler functions. At the end of this post, our kernel will be able to catch divide-by-zero faults.</p>
<span id="continue-reading"></span>
<p>As always, the complete source code is on <a href="https://github.com/phil-opp/blog_os/tree/catching_exceptions">GitHub</a>. Please file <a href="https://github.com/phil-opp/blog_os/issues">issues</a> for any problems, questions, or improvement suggestions. There is also a comment section at the end of this page.</p>
<blockquote>
<p><strong>Note</strong>: This post describes how to handle exceptions using naked functions (see <a href="https://os.phil-opp.com/edition-1/extra/naked-exceptions/">‚ÄúHandling Exceptions with Naked Functions‚Äù</a> for an overview). Our new way of handling exceptions can be found in the <a href="../handling-exceptions/index.html">‚ÄúHandling Exceptions‚Äù</a> post.</p>
</blockquote>
<h2 id="exceptions"><a class="zola-anchor" href="index.html#exceptions" aria-label="Anchor link for: exceptions">üîó</a>Exceptions</h2>
<p>An exception signals that something is wrong with the current instruction. For example, the CPU issues an exception if the current instruction tries to divide by 0. When an exception occurs, the CPU interrupts its current work and immediately calls a specific exception handler function, depending on the exception type.</p>
<p>We‚Äôve already seen several types of exceptions in our kernel:</p>
<ul>
<li><strong>Invalid Opcode</strong>: This exception occurs when the current instruction is invalid. For example, this exception occurred when we tried to use SSE instructions before enabling SSE. Without SSE, the CPU didn‚Äôt know the <code>movups</code> and <code>movaps</code> instructions, so it throws an exception when it stumbles over them.</li>
<li><strong>Page Fault</strong>: A page fault occurs on illegal memory accesses. For example, if the current instruction tries to read from an unmapped page or tries to write to a read-only page.</li>
<li><strong>Double Fault</strong>: When an exception occurs, the CPU tries to call the corresponding handler function. If another exception exception occurs <em>while calling the exception handler</em>, the CPU raises a double fault exception. This exception also occurs when there is no handler function registered for an exception.</li>
<li><strong>Triple Fault</strong>: If an exception occurs while the CPU tries to call the double fault handler function, it issues a fatal <em>triple fault</em>. We can‚Äôt catch or handle a triple fault. Most processors react by resetting themselves and rebooting the operating system. This causes the bootloops we experienced in the previous posts.</li>
</ul>
<p>For the full list of exceptions check out the <a href="https://wiki.osdev.org/Exceptions">OSDev wiki</a>.</p>
<h3 id="the-interrupt-descriptor-table"><a class="zola-anchor" href="index.html#the-interrupt-descriptor-table" aria-label="Anchor link for: the-interrupt-descriptor-table">üîó</a>The Interrupt Descriptor Table</h3>
<p>In order to catch and handle exceptions, we have to set up a so-called <em>Interrupt Descriptor Table</em> (IDT). In this table we can specify a handler function for each CPU exception. The hardware uses this table directly, so we need to follow a predefined format. Each entry must have the following 16-byte structure:</p>
<table><thead><tr><th>Type</th><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td>u16</td><td>Function Pointer [0:15]</td><td>The lower bits of the pointer to the handler function.</td></tr>
<tr><td>u16</td><td>GDT selector</td><td>Selector of a code segment in the GDT.</td></tr>
<tr><td>u16</td><td>Options</td><td>(see below)</td></tr>
<tr><td>u16</td><td>Function Pointer [16:31]</td><td>The middle bits of the pointer to the handler function.</td></tr>
<tr><td>u32</td><td>Function Pointer [32:63]</td><td>The remaining bits of the pointer to the handler function.</td></tr>
<tr><td>u32</td><td>Reserved</td><td></td></tr>
</tbody></table>
<p>The options field has the following format:</p>
<table><thead><tr><th>Bits</th><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td>0-2</td><td>Interrupt Stack Table Index</td><td>0: Don‚Äôt switch stacks, 1-7: Switch to the n-th stack in the Interrupt Stack Table when this handler is called.</td></tr>
<tr><td>3-7</td><td>Reserved</td><td></td></tr>
<tr><td>8</td><td>0: Interrupt Gate, 1: Trap Gate</td><td>If this bit is 0, interrupts are disabled when this handler is called.</td></tr>
<tr><td>9-11</td><td>must be one</td><td></td></tr>
<tr><td>12</td><td>must be zero</td><td></td></tr>
<tr><td>13‚Äë14</td><td>Descriptor Privilege Level (DPL)</td><td>The minimal privilege level required for calling this handler.</td></tr>
<tr><td>15</td><td>Present</td><td></td></tr>
</tbody></table>
<p>Each exception has a predefined IDT index. For example the invalid opcode exception has table index 6 and the page fault exception has table index 14. Thus, the hardware can automatically load the corresponding IDT entry for each exception. The <a href="https://wiki.osdev.org/Exceptions">Exception Table</a> in the OSDev wiki shows the IDT indexes of all exceptions in the ‚ÄúVector nr.‚Äù column.</p>
<p>When an exception occurs, the CPU roughly does the following:</p>
<ol>
<li>Read the corresponding entry from the Interrupt Descriptor Table (IDT). For example, the CPU reads the 14-th entry when a page fault occurs.</li>
<li>Check if the entry is present. Raise a double fault if not.</li>
<li>Push some registers on the stack, including the instruction pointer and the <a href="https://en.wikipedia.org/wiki/FLAGS_register">EFLAGS</a> register. (We will use these values in a future post.)</li>
<li>Disable interrupts if the entry is an interrupt gate (bit 40 not set).</li>
<li>Load the specified GDT selector into the CS segment.</li>
<li>Jump to the specified handler function.</li>
</ol>
<h2 id="handling-exceptions"><a class="zola-anchor" href="index.html#handling-exceptions" aria-label="Anchor link for: handling-exceptions">üîó</a>Handling Exceptions</h2>
<p>Let‚Äôs try to catch and handle CPU exceptions. We start by creating a new <code>interrupts</code> module with an <code>idt</code> submodule:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/lib.rs
</span><span style="color:#569cd6;">...
</span><span style="color:#569cd6;">mod </span><span>interrupts;
</span><span style="color:#569cd6;">...
</span></code></pre>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// src/interrupts/mod.rs
</span><span>
</span><span style="color:#569cd6;">mod </span><span>idt;
</span></code></pre>
<p>Now we create types for the IDT and its entries:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// src/interrupts/idt.rs
</span><span>
</span><span style="color:#569cd6;">use </span><span>x86_64::instructions::segmentation;
</span><span style="color:#569cd6;">use </span><span>x86_64::structures::gdt::SegmentSelector;
</span><span style="color:#569cd6;">use </span><span>x86_64::PrivilegeLevel;
</span><span>
</span><span style="color:#569cd6;">pub struct </span><span>Idt([Entry; 16]);
</span><span>
</span><span>#[derive(Debug, Clone, Copy)]
</span><span>#[repr(C, packed)]
</span><span style="color:#569cd6;">pub struct </span><span>Entry {
</span><span>    pointer_low: </span><span style="color:#569cd6;">u16</span><span>,
</span><span>    gdt_selector: SegmentSelector,
</span><span>    options: EntryOptions,
</span><span>    pointer_middle: </span><span style="color:#569cd6;">u16</span><span>,
</span><span>    pointer_high: </span><span style="color:#569cd6;">u32</span><span>,
</span><span>    reserved: </span><span style="color:#569cd6;">u32</span><span>,
</span><span>}
</span></code></pre>
<p>The IDT is variable sized and can have up to 256 entries. We only need the first 16 entries in this post, so we define the table as <code>[Entry; 16]</code>. The remaining 240 handlers are treated as non-present by the CPU.</p>
<p>The <code>Entry</code> type is the translation of the above table to Rust. The <code>repr(C, packed)</code> attribute ensures that the compiler keeps the field ordering and does not add any padding between them. Instead of describing the <code>gdt_selector</code> as a plain <code>u16</code>, we use the <code>SegmentSelector</code> type of the <code>x86</code> crate. We also merge bits 32 to 47 into an <code>option</code> field, because Rust has no <code>u3</code> or <code>u1</code> type. The <code>EntryOptions</code> type is described below:</p>
<h3 id="entry-options"><a class="zola-anchor" href="index.html#entry-options" aria-label="Anchor link for: entry-options">üîó</a>Entry Options</h3>
<p>The <code>EntryOptions</code> type has the following skeleton:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span>#[derive(Debug, Clone, Copy)]
</span><span style="color:#569cd6;">pub struct </span><span>EntryOptions(</span><span style="color:#569cd6;">u16</span><span>);
</span><span>
</span><span style="color:#569cd6;">impl </span><span>EntryOptions {
</span><span>    </span><span style="color:#569cd6;">fn </span><span>new() -&gt; </span><span style="color:#569cd6;">Self </span><span>{</span><span style="color:#569cd6;">...</span><span>}
</span><span>
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>set_present(</span><span style="color:#569cd6;">&amp;mut </span><span>self, present: </span><span style="color:#569cd6;">bool</span><span>) {</span><span style="color:#569cd6;">...</span><span>}
</span><span>
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>disable_interrupts(</span><span style="color:#569cd6;">&amp;mut </span><span>self, disable: </span><span style="color:#569cd6;">bool</span><span>) {</span><span style="color:#569cd6;">...</span><span>}
</span><span>
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>set_privilege_level(</span><span style="color:#569cd6;">&amp;mut </span><span>self, dpl: </span><span style="color:#569cd6;">u16</span><span>) {</span><span style="color:#569cd6;">...</span><span>}
</span><span>
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>set_stack_index(</span><span style="color:#569cd6;">&amp;mut </span><span>self, index: </span><span style="color:#569cd6;">u16</span><span>) {</span><span style="color:#569cd6;">...</span><span>}
</span><span>}
</span></code></pre>
<p>The implementations of these methods need to modify the correct bits of the <code>u16</code> without touching the other bits. For example, we would need the following bit-fiddling to set the stack index:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span>self.</span><span style="color:#b5cea8;">0 </span><span>= (self.</span><span style="color:#b5cea8;">0 </span><span style="color:#569cd6;">&amp; </span><span style="color:#b5cea8;">0xfff8</span><span>) </span><span style="color:#569cd6;">|</span><span> stack_index;
</span></code></pre>
<p>Or alternatively:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span>self.</span><span style="color:#b5cea8;">0 </span><span>= (self.</span><span style="color:#b5cea8;">0 </span><span style="color:#569cd6;">&amp; </span><span>(</span><span style="color:#569cd6;">!</span><span style="color:#b5cea8;">0b111</span><span>)) </span><span style="color:#569cd6;">|</span><span> stack_index;
</span></code></pre>
<p>Or:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span>self.</span><span style="color:#b5cea8;">0 </span><span>= ((self.</span><span style="color:#b5cea8;">0 </span><span>&gt;&gt; </span><span style="color:#b5cea8;">3</span><span>) &lt;&lt; </span><span style="color:#b5cea8;">3</span><span>) </span><span style="color:#569cd6;">|</span><span> stack_index;
</span></code></pre>
<p>Well, none of these variants is really <em>readable</em> and it‚Äôs very easy to make mistakes somewhere. Therefore I created a <code>BitField</code> trait that provides the following <a href="https://doc.rust-lang.org/nightly/core/ops/struct.Range.html">Range</a>-based API:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span>self.</span><span style="color:#b5cea8;">0.</span><span>set_bits(</span><span style="color:#b5cea8;">0</span><span style="color:#569cd6;">..</span><span style="color:#b5cea8;">3</span><span>, stack_index);
</span></code></pre>
<p>I think it is much more readable, since we abstracted away all bit-masking details. The <code>BitField</code> trait is contained in the <a href="https://crates.io/crates/bit_field">bit_field</a> crate. (It‚Äôs pretty new, so it might still contain bugs.) To add it as dependency, we run <code>cargo add bit_field</code> and add <code>extern crate bit_field;</code> to our <code>src/lib.rs</code>.</p>
<p>Now we can use the trait to implement the methods of <code>EntryOptions</code>:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/interrupts/idt.rs
</span><span>
</span><span style="color:#569cd6;">use </span><span>bit_field::BitField;
</span><span>
</span><span>#[derive(Debug, Clone, Copy)]
</span><span style="color:#569cd6;">pub struct </span><span>EntryOptions(</span><span style="color:#569cd6;">u16</span><span>);
</span><span>
</span><span style="color:#569cd6;">impl </span><span>EntryOptions {
</span><span>    </span><span style="color:#569cd6;">fn </span><span>minimal() -&gt; </span><span style="color:#569cd6;">Self </span><span>{
</span><span>        </span><span style="color:#569cd6;">let mut</span><span> options = </span><span style="color:#b5cea8;">0</span><span>;
</span><span>        options.set_bits(</span><span style="color:#b5cea8;">9</span><span style="color:#569cd6;">..</span><span style="color:#b5cea8;">12</span><span>, </span><span style="color:#b5cea8;">0b111</span><span>); </span><span style="color:#608b4e;">// &#39;must-be-one&#39; bits
</span><span>        EntryOptions(options)
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#569cd6;">fn </span><span>new() -&gt; </span><span style="color:#569cd6;">Self </span><span>{
</span><span>        </span><span style="color:#569cd6;">let mut</span><span> options = </span><span style="color:#569cd6;">Self</span><span>::minimal();
</span><span>        options.set_present(</span><span style="color:#569cd6;">true</span><span>).disable_interrupts(</span><span style="color:#569cd6;">true</span><span>);
</span><span>        options
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>set_present(</span><span style="color:#569cd6;">&amp;mut </span><span>self, present: </span><span style="color:#569cd6;">bool</span><span>) -&gt; </span><span style="color:#569cd6;">&amp;mut Self </span><span>{
</span><span>        self.</span><span style="color:#b5cea8;">0.</span><span>set_bit(</span><span style="color:#b5cea8;">15</span><span>, present);
</span><span>        self
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>disable_interrupts(</span><span style="color:#569cd6;">&amp;mut </span><span>self, disable: </span><span style="color:#569cd6;">bool</span><span>) -&gt; </span><span style="color:#569cd6;">&amp;mut Self </span><span>{
</span><span>        self.</span><span style="color:#b5cea8;">0.</span><span>set_bit(</span><span style="color:#b5cea8;">8</span><span>, </span><span style="color:#569cd6;">!</span><span>disable);
</span><span>        self
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>set_privilege_level(</span><span style="color:#569cd6;">&amp;mut </span><span>self, dpl: </span><span style="color:#569cd6;">u16</span><span>) -&gt; </span><span style="color:#569cd6;">&amp;mut Self </span><span>{
</span><span>        self.</span><span style="color:#b5cea8;">0.</span><span>set_bits(</span><span style="color:#b5cea8;">13</span><span style="color:#569cd6;">..</span><span style="color:#b5cea8;">15</span><span>, dpl);
</span><span>        self
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>set_stack_index(</span><span style="color:#569cd6;">&amp;mut </span><span>self, index: </span><span style="color:#569cd6;">u16</span><span>) -&gt; </span><span style="color:#569cd6;">&amp;mut Self </span><span>{
</span><span>        self.</span><span style="color:#b5cea8;">0.</span><span>set_bits(</span><span style="color:#b5cea8;">0</span><span style="color:#569cd6;">..</span><span style="color:#b5cea8;">3</span><span>, index);
</span><span>        self
</span><span>    }
</span><span>}
</span></code></pre>
<p>Note that the ranges are <em>exclusive</em> the upper bound. The <code>minimal</code> function creates an <code>EntryOptions</code> type with only the ‚Äúmust-be-one‚Äù bits set. The <code>new</code> function, on the other hand, chooses reasonable defaults: It sets the present bit (why would you want to create a non-present entry?) and disables interrupts (normally we don‚Äôt want that our exception handlers can be interrupted). By returning the self pointer from the <code>set_*</code> methods, we allow easy method chaining such as <code>options.set_present(true).disable_interrupts(true)</code>.</p>
<h3 id="creating-idt-entries"><a class="zola-anchor" href="index.html#creating-idt-entries" aria-label="Anchor link for: creating-idt-entries">üîó</a>Creating IDT Entries</h3>
<p>Now we can add a function to create new IDT entries:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#569cd6;">impl </span><span>Entry {
</span><span>    </span><span style="color:#569cd6;">fn </span><span>new(gdt_selector: SegmentSelector, handler: HandlerFunc) -&gt; </span><span style="color:#569cd6;">Self </span><span>{
</span><span>        </span><span style="color:#569cd6;">let</span><span> pointer = handler </span><span style="color:#569cd6;">as u64</span><span>;
</span><span>        Entry {
</span><span>            gdt_selector: gdt_selector,
</span><span>            pointer_low: pointer </span><span style="color:#569cd6;">as u16</span><span>,
</span><span>            pointer_middle: (pointer &gt;&gt; </span><span style="color:#b5cea8;">16</span><span>) </span><span style="color:#569cd6;">as u16</span><span>,
</span><span>            pointer_high: (pointer &gt;&gt; </span><span style="color:#b5cea8;">32</span><span>) </span><span style="color:#569cd6;">as u32</span><span>,
</span><span>            options: EntryOptions::new(),
</span><span>            reserved: </span><span style="color:#b5cea8;">0</span><span>,
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre>
<p>We take a GDT selector and a handler function as arguments and create a new IDT entry for it. The <code>HandlerFunc</code> type is described below. It is a function pointer that can be converted to an <code>u64</code>. We choose the lower 16 bits for <code>pointer_low</code>, the next 16 bits for <code>pointer_middle</code> and the remaining 32 bits for <code>pointer_high</code>. For the options field we choose our default options, i.e. present and disabled interrupts.</p>
<h3 id="the-handler-function-type"><a class="zola-anchor" href="index.html#the-handler-function-type" aria-label="Anchor link for: the-handler-function-type">üîó</a>The Handler Function Type</h3>
<p>The <code>HandlerFunc</code> type is a type alias for a function type:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#569cd6;">pub type </span><span style="color:#4ec9b0;">HandlerFunc </span><span>= </span><span style="color:#569cd6;">extern </span><span style="color:#d69d85;">&quot;C&quot; </span><span style="color:#569cd6;">fn</span><span>() -&gt; </span><span style="color:#569cd6;">!</span><span>;
</span></code></pre>
<p>It needs to be a function with a defined <a href="https://en.wikipedia.org/wiki/Calling_convention">calling convention</a>, as it called directly by the hardware. The C calling convention is the de facto standard in OS development, so we‚Äôre using it, too. The function takes no arguments, since the hardware doesn‚Äôt supply any arguments when jumping to the handler function.</p>
<p>It is important that the function is <a href="https://doc.rust-lang.org/rust-by-example/fn/diverging.html">diverging</a>, i.e. it must never return. The reason is that the hardware doesn‚Äôt <em>call</em> the handler functions, it just <em>jumps</em> to them after pushing some values to the stack. So our stack might look different:</p>
<p><img src="normal-vs-interrupt-function-return.svg" alt="normal function return vs interrupt function return" /></p>
<p>If our handler function returned normally, it would try to pop the return address from the stack. But it might get some completely different value then. For example, the CPU pushes an error code for some exceptions. Bad things would happen if we interpreted this error code as return address and jumped to it. Therefore interrupt handler functions must diverge<sup class="footnote-reference"><a href="index.html#fn-must-diverge">1</a></sup>.</p>
<div class="footnote-definition" id="fn-must-diverge"><sup class="footnote-definition-label">1</sup>
<p>Another reason is that we overwrite the current register values by executing the handler function. Thus, the interrupted function looses its state and can‚Äôt proceed anyway.</p>
</div>
<h3 id="idt-methods"><a class="zola-anchor" href="index.html#idt-methods" aria-label="Anchor link for: idt-methods">üîó</a>IDT methods</h3>
<p>Let‚Äôs add a function to create new interrupt descriptor tables:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#569cd6;">impl </span><span>Idt {
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>new() -&gt; Idt {
</span><span>        Idt([Entry::missing(); </span><span style="color:#b5cea8;">16</span><span>])
</span><span>    }
</span><span>}
</span><span>
</span><span style="color:#569cd6;">impl </span><span>Entry {
</span><span>    </span><span style="color:#569cd6;">fn </span><span>missing() -&gt; </span><span style="color:#569cd6;">Self </span><span>{
</span><span>        Entry {
</span><span>            gdt_selector: SegmentSelector::new(</span><span style="color:#b5cea8;">0</span><span>, PrivilegeLevel::Ring0),
</span><span>            pointer_low: </span><span style="color:#b5cea8;">0</span><span>,
</span><span>            pointer_middle: </span><span style="color:#b5cea8;">0</span><span>,
</span><span>            pointer_high: </span><span style="color:#b5cea8;">0</span><span>,
</span><span>            options: EntryOptions::minimal(),
</span><span>            reserved: </span><span style="color:#b5cea8;">0</span><span>,
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre>
<p>The <code>missing</code> function creates a non-present Entry. We could choose any values for the pointer and GDT selector fields as long as the present bit is not set.</p>
<p>However, a table with non-present entries is not very useful. So we create a <code>set_handler</code> method to add new handler functions:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#569cd6;">impl </span><span>Idt {
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>set_handler(</span><span style="color:#569cd6;">&amp;mut </span><span>self, entry: </span><span style="color:#569cd6;">u8</span><span>, handler: HandlerFunc)
</span><span>        -&gt; </span><span style="color:#569cd6;">&amp;mut</span><span> EntryOptions
</span><span>    {
</span><span>        self.</span><span style="color:#b5cea8;">0</span><span>[entry </span><span style="color:#569cd6;">as usize</span><span>] = Entry::new(segmentation::cs(), handler);
</span><span>        </span><span style="color:#569cd6;">&amp;mut </span><span>self.</span><span style="color:#b5cea8;">0</span><span>[entry </span><span style="color:#569cd6;">as usize</span><span>].options
</span><span>    }
</span><span>}
</span></code></pre>
<p>The method overwrites the specified entry with the given handler function. We use the <code>segmentation::cs</code> function of the <a href="https://docs.rs/x86_64">x86_64 crate</a> to get the current code segment descriptor. There‚Äôs no need for different kernel code segments in long mode, so the current <code>cs</code> value should be always the right choice.</p>
<p>By returning a mutual reference to the entry‚Äôs options, we allow the caller to override the default settings. For example, the caller could add a non-present entry by executing: <code>idt.set_handler(11, handler_fn).set_present(false)</code>.</p>
<h3 id="loading-the-idt"><a class="zola-anchor" href="index.html#loading-the-idt" aria-label="Anchor link for: loading-the-idt">üîó</a>Loading the IDT</h3>
<p>Now we‚Äôre able to create new interrupt descriptor tables with registered handler functions. We just need a way to load an IDT, so that the CPU uses it. The x86 architecture uses a special register to store the active IDT and its length. In order to load a new IDT we need to update this register through the <a href="https://www.felixcloutier.com/x86/lgdt:lidt">lidt</a> instruction.</p>
<p>The <code>lidt</code> instruction expects a pointer to a special data structure, which specifies the start address of the IDT and its length:</p>
<table><thead><tr><th>Type</th><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td>u16</td><td>Limit</td><td>The maximum addressable byte in the table. Equal to the table size in bytes minus 1.</td></tr>
<tr><td>u64</td><td>Offset</td><td>Virtual start address of the table.</td></tr>
</tbody></table>
<p>This structure is already contained <a href="https://docs.rs/x86_64/0.1.0/x86_64/instructions/tables/struct.DescriptorTablePointer.html">in the x86_64 crate</a>, so we don‚Äôt need to create it ourselves. The same is true for the <a href="https://docs.rs/x86_64/0.1.0/x86_64/instructions/tables/fn.lidt.html">lidt function</a>. So we just need to put the pieces together to create a <code>load</code>  method:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#569cd6;">impl </span><span>Idt {
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>load(</span><span style="color:#569cd6;">&amp;</span><span>self) {
</span><span>        </span><span style="color:#569cd6;">use </span><span>x86_64::instructions::tables::{DescriptorTablePointer, lidt};
</span><span>        </span><span style="color:#569cd6;">use </span><span>core::mem::size_of;
</span><span>
</span><span>        </span><span style="color:#569cd6;">let</span><span> ptr = DescriptorTablePointer {
</span><span>            base: self </span><span style="color:#569cd6;">as *const _ as u64</span><span>,
</span><span>            limit: (size_of::&lt;</span><span style="color:#569cd6;">Self</span><span>&gt;() - </span><span style="color:#b5cea8;">1</span><span>) </span><span style="color:#569cd6;">as u16</span><span>,
</span><span>        };
</span><span>
</span><span>        </span><span style="color:#569cd6;">unsafe </span><span>{ lidt(</span><span style="color:#569cd6;">&amp;</span><span>ptr) };
</span><span>    }
</span><span>}
</span></code></pre>
<p>The method does not need to modify the IDT, so it takes <code>self</code> by immutable reference. First, we create a <code>DescriptorTablePointer</code> and then we pass it to <code>lidt</code>. The <code>lidt</code> function expects that the <code>base</code> field has the type <code>u64</code>, therefore we need to cast the <code>self</code> pointer. For calculating the <code>limit</code> we use <a href="https://doc.rust-lang.org/nightly/core/mem/fn.size_of.html">mem::size_of</a>. The additional <code>-1</code> is needed because the limit field has to be the maximum addressable byte (inclusive bound). We need an unsafe block around <code>lidt</code>, because the function assumes that the specified handler addresses are valid.</p>
<h4 id="safety"><a class="zola-anchor" href="index.html#safety" aria-label="Anchor link for: safety">üîó</a>Safety</h4>
<p>But can we really guarantee that handler addresses are always valid? Let‚Äôs see:</p>
<ul>
<li>The <code>Idt::new</code> function creates a new table populated with non-present entries. There‚Äôs no way to set these entries to present from outside of this module, so this function is fine.</li>
<li>The <code>set_handler</code> method allows us to overwrite a specified entry and point it to some handler function. Rust‚Äôs type system guarantees that function pointers are always valid (as long as no <code>unsafe</code> is involved), so this function is fine, too.</li>
</ul>
<p>There are no other public functions in the <code>idt</code> module (except <code>load</code>), so it should be safe‚Ä¶ right?</p>
<p>Wrong! Imagine the following scenario:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#569cd6;">pub fn </span><span>init() {
</span><span>    load_idt();
</span><span>    cause_page_fault();
</span><span>}
</span><span>
</span><span style="color:#569cd6;">fn </span><span>load_idt() {
</span><span>    </span><span style="color:#569cd6;">let mut</span><span> idt = idt::Idt::new();
</span><span>    idt.set_handler(</span><span style="color:#b5cea8;">14</span><span>, page_fault_handler);
</span><span>    idt.load();
</span><span>}
</span><span>
</span><span style="color:#569cd6;">fn </span><span>cause_page_fault() {
</span><span>    </span><span style="color:#569cd6;">let</span><span> x = [</span><span style="color:#b5cea8;">1</span><span>,</span><span style="color:#b5cea8;">2</span><span>,</span><span style="color:#b5cea8;">3</span><span>,</span><span style="color:#b5cea8;">4</span><span>,</span><span style="color:#b5cea8;">5</span><span>,</span><span style="color:#b5cea8;">6</span><span>,</span><span style="color:#b5cea8;">7</span><span>,</span><span style="color:#b5cea8;">8</span><span>,</span><span style="color:#b5cea8;">9</span><span>];
</span><span>    </span><span style="color:#569cd6;">unsafe</span><span>{ *(</span><span style="color:#b5cea8;">0xdeadbeaf </span><span style="color:#569cd6;">as *mut u64</span><span>) = x[</span><span style="color:#b5cea8;">4</span><span>] };
</span><span>}
</span></code></pre>
<p>This won‚Äôt work. If we‚Äôre lucky, we get a triple fault and a boot loop. If we‚Äôre unlucky, our kernel does strange things and fails at some completely unrelated place. So what‚Äôs the problem here?</p>
<p>Well, we construct an IDT <em>on the stack</em> and load it. It is perfectly valid until the end of the <code>load_idt</code> function. But as soon as the function returns, its stack frame can be reused by other functions. Thus, the IDT gets overwritten by the stack frame of the <code>cause_page_fault</code> function. So when the page fault occurs and the CPU tries to read the entry, it only sees some garbage values and issues a double fault, which escalates to a triple fault and a CPU reset.</p>
<p>Now imagine that the <code>cause_page_fault</code> function declared an array of pointers instead. If the present was coincidentally set, the CPU would jump to some random pointer and interpret random memory as code. This would be a clear violation of memory safety.</p>
<h4 id="fixing-the-load-method"><a class="zola-anchor" href="index.html#fixing-the-load-method" aria-label="Anchor link for: fixing-the-load-method">üîó</a>Fixing the load method</h4>
<p>So how do we fix it? We could make the load function itself <code>unsafe</code> and push the unsafety to the caller. However, there is a much better solution in this case. In order to see it, we formulate the requirement for the <code>load</code> method:</p>
<blockquote>
<p>The referenced IDT must be valid until a new IDT is loaded.</p>
</blockquote>
<p>We can‚Äôt know when the next IDT will be loaded. Maybe never. So in the worst case:</p>
<blockquote>
<p>The referenced IDT must be valid as long as our kernel runs.</p>
</blockquote>
<p>This is exactly the definition of a <a href="https://doc.rust-lang.org/rust-by-example/scope/lifetime/static_lifetime.html">static lifetime</a>. So we can easily ensure that the IDT lives long enough by adding a <code>'static</code> requirement to the signature of the <code>load</code> function:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#569cd6;">pub fn </span><span>load(</span><span style="color:#569cd6;">&amp;&#39;static </span><span>self) {</span><span style="color:#569cd6;">...</span><span>}
</span><span style="color:#608b4e;">//           ^^^^^^^ ensure that the IDT reference has the &#39;static lifetime
</span></code></pre>
<p>That‚Äôs it! Now the Rust compiler ensures that the above error can‚Äôt happen anymore:</p>
<pre style="background-color:#1e1e1e;color:#dcdcdc;"><code><span>error: `idt` does not live long enough
</span><span>  --&gt; src/interrupts/mod.rs:78:5
</span><span>78 |&gt;     idt.load();
</span><span>   |&gt;     ^^^
</span><span>note: reference must be valid for the static lifetime...
</span><span>note: ...but borrowed value is only valid for the block suffix following
</span><span>          statement 0 at 75:34
</span><span>  --&gt; src/interrupts/mod.rs:75:35
</span><span>75 |&gt;     let mut idt = idt::Idt::new();
</span><span>   |&gt;                                   ^
</span></code></pre>
<h3 id="a-static-idt"><a class="zola-anchor" href="index.html#a-static-idt" aria-label="Anchor link for: a-static-idt">üîó</a>A static IDT</h3>
<p>So a valid IDT needs to have the <code>'static</code> lifetime. We can either create a <code>static</code> IDT or <a href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html#method.into_raw">deliberately leak a Box</a>. We will most likely only need a single IDT for the foreseeable future, so let‚Äôs try the <code>static</code> approach:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/interrupts/mod.rs
</span><span>
</span><span style="color:#569cd6;">static </span><span style="color:#b4cea8;">IDT</span><span>: idt::Idt = {
</span><span>    </span><span style="color:#569cd6;">let mut</span><span> idt = idt::Idt::new();
</span><span>
</span><span>    idt.set_handler(</span><span style="color:#b5cea8;">0</span><span>, divide_by_zero_handler);
</span><span>
</span><span>    idt
</span><span>};
</span><span>
</span><span style="color:#569cd6;">extern </span><span style="color:#d69d85;">&quot;C&quot; </span><span style="color:#569cd6;">fn </span><span>divide_by_zero_handler() -&gt; </span><span style="color:#569cd6;">! </span><span>{
</span><span>    println!(</span><span style="color:#d69d85;">&quot;EXCEPTION: DIVIDE BY ZERO&quot;</span><span>);
</span><span>    </span><span style="color:#569cd6;">loop </span><span>{}
</span><span>}
</span></code></pre>
<p>We register a single handler function for a <a href="https://wiki.osdev.org/Exceptions#Divide-by-zero_Error">divide by zero error</a> (index 0). Like the name says, this exception occurs when dividing a number by 0. Thus we have an easy way to test our new exception handler.</p>
<p>However, it doesn‚Äôt work this way:</p>
<pre style="background-color:#1e1e1e;color:#dcdcdc;"><code><span>error: calls in statics are limited to constant functions, struct and enum
</span><span>       constructors [E0015]
</span><span>...
</span><span>error: blocks in statics are limited to items and tail expressions [E0016]
</span><span>...
</span><span>error: references in statics may only refer to immutable values [E0017]
</span><span>...
</span></code></pre>
<p>The reason is that the Rust compiler is not able to evaluate the value of the <code>static</code> at compile time. Maybe it will work someday when <code>const</code> functions become more powerful. But until then, we have to find another solution.</p>
<h4 id="lazy-statics-to-the-rescue"><a class="zola-anchor" href="index.html#lazy-statics-to-the-rescue" aria-label="Anchor link for: lazy-statics-to-the-rescue">üîó</a>Lazy Statics to the Rescue</h4>
<p>Fortunately the <code>lazy_static</code> macro exists. Instead of evaluating a <code>static</code> at compile time, the macro performs the initialization when the <code>static</code> is referenced the first time. Thus, we can do almost everything in the initialization block and are even able to read runtime values.</p>
<p>Let‚Äôs add the <code>lazy_static</code> crate to our project:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/lib.rs
</span><span>
</span><span>#[macro_use]
</span><span style="color:#569cd6;">extern crate</span><span> lazy_static;
</span></code></pre>
<pre data-lang="toml" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-toml "><code class="language-toml" data-lang="toml"><span style="color:#608b4e;"># in Cargo.toml
</span><span>
</span><span>[</span><span style="color:#808080;">dependencies.lazy_static</span><span>]
</span><span style="color:#569cd6;">version </span><span>= </span><span style="color:#d69d85;">&quot;0.2.1&quot;
</span><span style="color:#569cd6;">features </span><span>= [</span><span style="color:#d69d85;">&quot;spin_no_std&quot;</span><span>]
</span></code></pre>
<p>We need the <code>spin_no_std</code> feature, since we don‚Äôt link the standard library.</p>
<p>With <code>lazy_static</code>, we can define our IDT without problems:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/interrupts/mod.rs
</span><span>
</span><span>lazy_static! {
</span><span>    </span><span style="color:#569cd6;">static ref </span><span style="color:#b4cea8;">IDT</span><span>: idt::Idt = {
</span><span>        </span><span style="color:#569cd6;">let mut</span><span> idt = idt::Idt::new();
</span><span>
</span><span>        idt.set_handler(</span><span style="color:#b5cea8;">0</span><span>, divide_by_zero_handler);
</span><span>
</span><span>        idt
</span><span>    };
</span><span>}
</span></code></pre>
<p>Now we‚Äôre ready to load our IDT! Therefore we add a <code>interrupts::init</code> function:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/interrupts/mod.rs
</span><span>
</span><span style="color:#569cd6;">pub fn </span><span>init() {
</span><span>    </span><span style="color:#b4cea8;">IDT</span><span>.load();
</span><span>}
</span></code></pre>
<p>We don‚Äôt need our <code>assert_has_not_been_called</code> macro here, since nothing bad happens when <code>init</code> is called twice. It just reloads the same IDT again.</p>
<h2 id="testing-it"><a class="zola-anchor" href="index.html#testing-it" aria-label="Anchor link for: testing-it">üîó</a>Testing it</h2>
<p>Now we should be able to catch page faults! Let‚Äôs try it in our <code>rust_main</code>:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/lib.rs
</span><span>
</span><span style="color:#569cd6;">pub extern </span><span style="color:#d69d85;">&quot;C&quot; </span><span style="color:#569cd6;">fn </span><span>rust_main(...) {
</span><span>    </span><span style="color:#569cd6;">...
</span><span>    memory::init(boot_info);
</span><span>
</span><span>    </span><span style="color:#608b4e;">// initialize our IDT
</span><span>    interrupts::init();
</span><span>
</span><span>    </span><span style="color:#608b4e;">// provoke a divide-by-zero fault
</span><span>    </span><span style="color:#b5cea8;">42 </span><span>/ </span><span style="color:#b5cea8;">0</span><span>;
</span><span>
</span><span>    println!(</span><span style="color:#d69d85;">&quot;It did not crash!&quot;</span><span>);
</span><span>    </span><span style="color:#569cd6;">loop </span><span>{}
</span><span>}
</span></code></pre>
<p>When we run it, we get a runtime panic:</p>
<pre style="background-color:#1e1e1e;color:#dcdcdc;"><code><span>PANIC in src/lib.rs at line 57:
</span><span>    attempted to divide by zero
</span></code></pre>
<p>That‚Äôs a not our exception handler. The reason is that Rust itself checks for a possible division by zero and panics in that case. So in order to raise a divide-by-zero error in the CPU, we need to bypass the Rust compiler somehow.</p>
<h3 id="inline-assembly"><a class="zola-anchor" href="index.html#inline-assembly" aria-label="Anchor link for: inline-assembly">üîó</a>Inline Assembly</h3>
<p>In order to cause a divide-by-zero exception, we need to execute a <a href="https://www.felixcloutier.com/x86/div">div</a> or <a href="https://www.felixcloutier.com/x86/idiv">idiv</a> assembly instruction with operand 0. We could write a small assembly function and call it from our Rust code. An easier way is to use Rust‚Äôs <a href="https://doc.rust-lang.org/1.10.0/book/inline-assembly.html">inline assembly</a> macro.</p>
<p>Inline assembly allows us to write raw x86 assembly within a Rust function. The feature is unstable, so we need to add <code>#![feature(asm)]</code> to our <code>src/lib.rs</code>. Then we‚Äôre able to write a <code>divide_by_zero</code> function:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#569cd6;">fn </span><span>divide_by_zero() {
</span><span>    </span><span style="color:#569cd6;">unsafe </span><span>{
</span><span>        asm!(</span><span style="color:#d69d85;">&quot;mov dx, 0; div dx&quot; </span><span>::: </span><span style="color:#d69d85;">&quot;ax&quot;</span><span>, </span><span style="color:#d69d85;">&quot;dx&quot; </span><span>: </span><span style="color:#d69d85;">&quot;volatile&quot;</span><span>, </span><span style="color:#d69d85;">&quot;intel&quot;</span><span>)
</span><span>    }
</span><span>}
</span></code></pre>
<p>Let‚Äôs try to decode it:</p>
<ul>
<li>The <code>asm!</code> macro emits raw assembly instructions, so it‚Äôs <code>unsafe</code> to use it.</li>
<li>We insert two assembly instructions here: <code>mov dx, 0</code> and <code>div dx</code>. The former loads a 0 into the <code>dx</code> register (a subset of <code>rdx</code>) and the latter divides the <code>ax</code> register by <code>dx</code>. (The <code>div</code> instruction always implicitly operates on the <code>ax</code> register).</li>
<li>The colons are separators. After the first <code>:</code> we could specify output operands and after the second <code>:</code> we could specify input operands. We need neither, so we leave these areas empty.</li>
<li>After the third colon, we specify the so-called <em>clobbers</em>. These tell the compiler that our assembly modifies the values of some registers. Otherwise, the compiler assumes that the registers preserve their value. In our case, we clobber <code>dx</code> (we load 0 to it) and <code>ax</code> (the <code>div</code> instruction places the result in it).</li>
<li>The last block (after the 4th colon) specifies some options. The <code>volatile</code> option tells the compiler: ‚ÄúThis code has side effects. Do not delete it and do not move it elsewhere‚Äù. In our case, the ‚Äúside effect‚Äù is the divide-by-zero exception. Finally, the <code>intel</code> option allows us to use the Intel assembly syntax instead of the default AT&amp;T syntax.</li>
</ul>
<p>Let‚Äôs use our new <code>divide_by_zero</code> function to raise a CPU exception:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/lib.rs
</span><span>
</span><span style="color:#569cd6;">pub extern </span><span style="color:#d69d85;">&quot;C&quot; </span><span style="color:#569cd6;">fn </span><span>rust_main(...) {
</span><span>    </span><span style="color:#569cd6;">...
</span><span>
</span><span>    </span><span style="color:#608b4e;">// provoke a divide-by-zero fault
</span><span>    divide_by_zero();
</span><span>
</span><span>    println!(</span><span style="color:#d69d85;">&quot;It did not crash!&quot;</span><span>);
</span><span>    </span><span style="color:#569cd6;">loop </span><span>{}
</span><span>}
</span></code></pre>
<p>It works! We see a <code>EXCEPTION: DIVIDE BY ZERO</code> message at the bottom of our screen:</p>
<p><img src="qemu-divide-error-println.png" alt="QEMU screenshot with EXCEPTION: DIVIDE BY ZERO message" /></p>
<h2 id="what-s-next"><a class="zola-anchor" href="index.html#what-s-next" aria-label="Anchor link for: what-s-next">üîó</a>What‚Äôs next?</h2>
<p>We‚Äôve successfully caught our first exception! However, our <code>EXCEPTION: DIVIDE BY ZERO</code> message doesn‚Äôt contain much information about the cause of the exception. The next post improves the situation by printing i.a. the current stack pointer and address of the causing instruction. We will also explore other exceptions such as page faults, for which the CPU pushes an <em>error code</em> on the stack.</p>

</main>

        <div>
    <hr>
    <div class="PageNavigation">
        
        
            <a class="next" href="../better-exception-messages/index.html">Better Exception Messages &raquo;</a>
        
    </div>

    <hr>
    <section>
        <h2>Comments (Archived)</h2>
        <section id="isso-thread">
    
        
<div id="isso-root"><div id="isso-190" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="09258dd0c920"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="20" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="20" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="20" y="20" width="8" height="8" style="fill: #9abf88"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Michelle Ramur</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-190" class="permalink"><time title="Sat May 28 2016 14:38:34 GMT+0200 (Central European Summer Time)" datetime="2016-04-06T12:38:34Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>Phil these tutorials are awesome, keep going!</p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"><div id="isso-193" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="666df3217240"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="20" y="12" width="8" height="8" style="fill: #9abf88"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Philipp Oppermann</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-193" class="permalink"><time title="Sat May 28 2016 23:32:11 GMT+0200 (Central European Summer Time)" datetime="2016-04-06T21:32:11Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>Thanks a lot :)</p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"></div></div></div></div></div></div><div id="isso-191" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="85c4515e13e7"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="4" width="8" height="8" style="fill: #447c69"></rect><rect x="36" y="4" width="8" height="8" style="fill: #447c69"></rect><rect x="12" y="4" width="8" height="8" style="fill: #447c69"></rect><rect x="28" y="4" width="8" height="8" style="fill: #447c69"></rect><rect x="12" y="28" width="8" height="8" style="fill: #447c69"></rect><rect x="28" y="28" width="8" height="8" style="fill: #447c69"></rect><rect x="12" y="36" width="8" height="8" style="fill: #447c69"></rect><rect x="28" y="36" width="8" height="8" style="fill: #447c69"></rect><rect x="20" y="4" width="8" height="8" style="fill: #447c69"></rect><rect x="20" y="12" width="8" height="8" style="fill: #447c69"></rect><rect x="20" y="20" width="8" height="8" style="fill: #447c69"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Fabio Cesar Canesin</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-191" class="permalink"><time title="Sat May 28 2016 19:16:17 GMT+0200 (Central European Summer Time)" datetime="2016-04-06T17:16:17Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>What is your view on Redox ? <a rel="nofollow" href="https://github.com/redox-os/redox">https://github.com/redox-os...</a></p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"><div id="isso-194" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="666df3217240"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="20" y="12" width="8" height="8" style="fill: #9abf88"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Philipp Oppermann</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-194" class="permalink"><time title="Sat May 28 2016 23:41:04 GMT+0200 (Central European Summer Time)" datetime="2016-04-06T21:41:04Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>I think it's very impressive how complete it already is and how fast it progresses. Really excited for its future!</p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"></div></div></div></div></div></div><div id="isso-192" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="666df3217240"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="20" y="12" width="8" height="8" style="fill: #9abf88"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Philipp Oppermann</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-192" class="permalink"><time title="Sat May 28 2016 23:31:31 GMT+0200 (Central European Summer Time)" datetime="2016-04-06T21:31:31Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>There's some great discussion on <a rel="nofollow" href="https://www.reddit.com/r/rust/comments/4lfx0f/writing_an_os_in_rust_catching_cpu_exceptions/">/r/rust</a> and <a rel="nofollow" href="https://news.ycombinator.com/item?id=11791694">hackernews</a>!</p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"></div></div></div><div id="isso-195" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="5a98e4dae93f"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="4" width="8" height="8" style="fill: #447c69"></rect><rect x="36" y="4" width="8" height="8" style="fill: #447c69"></rect><rect x="4" y="20" width="8" height="8" style="fill: #447c69"></rect><rect x="36" y="20" width="8" height="8" style="fill: #447c69"></rect><rect x="4" y="28" width="8" height="8" style="fill: #447c69"></rect><rect x="36" y="28" width="8" height="8" style="fill: #447c69"></rect><rect x="4" y="36" width="8" height="8" style="fill: #447c69"></rect><rect x="36" y="36" width="8" height="8" style="fill: #447c69"></rect><rect x="12" y="12" width="8" height="8" style="fill: #447c69"></rect><rect x="28" y="12" width="8" height="8" style="fill: #447c69"></rect><rect x="12" y="36" width="8" height="8" style="fill: #447c69"></rect><rect x="28" y="36" width="8" height="8" style="fill: #447c69"></rect><rect x="20" y="20" width="8" height="8" style="fill: #447c69"></rect><rect x="20" y="28" width="8" height="8" style="fill: #447c69"></rect><rect x="20" y="36" width="8" height="8" style="fill: #447c69"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Ben Anderson</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-195" class="permalink"><time title="Sun May 29 2016 10:40:32 GMT+0200 (Central European Summer Time)" datetime="2016-04-00T08:40:32Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>Awesome tutorials! Please please please keep writing them :)</p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"><div id="isso-196" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="666df3217240"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="20" y="12" width="8" height="8" style="fill: #9abf88"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Philipp Oppermann</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-196" class="permalink"><time title="Sun May 29 2016 11:54:46 GMT+0200 (Central European Summer Time)" datetime="2016-04-00T09:54:46Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>Thanks so much! Sure I will :)</p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"></div></div></div><div id="isso-197" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="5a98e4dae93f"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="4" width="8" height="8" style="fill: #447c69"></rect><rect x="36" y="4" width="8" height="8" style="fill: #447c69"></rect><rect x="4" y="20" width="8" height="8" style="fill: #447c69"></rect><rect x="36" y="20" width="8" height="8" style="fill: #447c69"></rect><rect x="4" y="28" width="8" height="8" style="fill: #447c69"></rect><rect x="36" y="28" width="8" height="8" style="fill: #447c69"></rect><rect x="4" y="36" width="8" height="8" style="fill: #447c69"></rect><rect x="36" y="36" width="8" height="8" style="fill: #447c69"></rect><rect x="12" y="12" width="8" height="8" style="fill: #447c69"></rect><rect x="28" y="12" width="8" height="8" style="fill: #447c69"></rect><rect x="12" y="36" width="8" height="8" style="fill: #447c69"></rect><rect x="28" y="36" width="8" height="8" style="fill: #447c69"></rect><rect x="20" y="20" width="8" height="8" style="fill: #447c69"></rect><rect x="20" y="28" width="8" height="8" style="fill: #447c69"></rect><rect x="20" y="36" width="8" height="8" style="fill: #447c69"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Ben Anderson</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-197" class="permalink"><time title="Sun May 29 2016 11:58:50 GMT+0200 (Central European Summer Time)" datetime="2016-04-00T09:58:50Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>I'm left wondering where you got all this knowledge from? Is such low level systems programming a hobby or a job?</p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"></div></div></div><div id="isso-198" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="666df3217240"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="20" y="12" width="8" height="8" style="fill: #9abf88"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Philipp Oppermann</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-198" class="permalink"><time title="Sun May 29 2016 12:59:05 GMT+0200 (Central European Summer Time)" datetime="2016-04-00T10:59:05Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>I'm a computer science student and I've taken some great OS courses. It's also a hobby of mine and I've experimented with a lot with toy x86 kernels and Rust. Most of the x86 information is from the <a rel="nofollow" href="https://wiki.osdev.org/Main_Page">OSDev wiki</a> and the <a rel="nofollow" href="http://www.intel.com/content/www/us/en/processors/architectures-software-developer-manuals.html">Intel</a>/<a rel="nofollow" href="https://developer.amd.com/resources/developer-guides-manuals/">AMD</a> manuals.</p><p>I also have a great research assistant job since November, where I try to bring Rust to an ARM Cortex-M7 board.</p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"></div></div></div></div></div></div><div id="isso-199" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="a5165bf53450"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="20" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="20" width="8" height="8" style="fill: #9abf88"></rect><rect x="20" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="20" y="28" width="8" height="8" style="fill: #9abf88"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Joe ST</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-199" class="permalink"><time title="Tue May 31 2016 11:21:23 GMT+0200 (Central European Summer Time)" datetime="2016-04-02T09:21:23Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>This is one of my favourite series, you're really doing such a great job of explaining bare-metal stuff to us all thank you!</p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"><div id="isso-201" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="666df3217240"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="20" y="12" width="8" height="8" style="fill: #9abf88"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Philipp Oppermann</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-201" class="permalink"><time title="Tue Jun 07 2016 21:19:36 GMT+0200 (Central European Summer Time)" datetime="2016-05-02T19:19:36Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>Thanks, glad you're liking it!</p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"></div></div></div></div></div></div><div id="isso-200" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="c8ac5b6db80f"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="12" width="8" height="8" style="fill: #447c69"></rect><rect x="36" y="12" width="8" height="8" style="fill: #447c69"></rect><rect x="4" y="20" width="8" height="8" style="fill: #447c69"></rect><rect x="36" y="20" width="8" height="8" style="fill: #447c69"></rect><rect x="4" y="36" width="8" height="8" style="fill: #447c69"></rect><rect x="36" y="36" width="8" height="8" style="fill: #447c69"></rect><rect x="12" y="4" width="8" height="8" style="fill: #447c69"></rect><rect x="28" y="4" width="8" height="8" style="fill: #447c69"></rect><rect x="12" y="12" width="8" height="8" style="fill: #447c69"></rect><rect x="28" y="12" width="8" height="8" style="fill: #447c69"></rect><rect x="20" y="36" width="8" height="8" style="fill: #447c69"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Andrew Nurse</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-200" class="permalink"><time title="Fri Jun 03 2016 04:07:52 GMT+0200 (Central European Summer Time)" datetime="2016-05-05T02:07:52Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>I actually encountered the println deadlock earlier while debugging something and solved it in a slightly different way. The problem generally occurs when a second println is encountered while evaluating one of the arguments to an outer println. So, I changed println to call a helper function called print_fmt which took in a core::fmt::Arguments. I used the format_args macro (<a rel="nofollow" href="https://doc.rust-lang.org/1.10.0/std/macro.format_args!.html">https://doc.rust-lang.org/n...</a> to evaluate the arguments and produce the core::fmt::Arguments, which I pass to print_fmt. Only within print_fmt do I actually take the lock on the WRITER, which means that all the expressions in the println! have been fully evaluated.</p><p>The advantage being you can nest println's as far as you want and you won't deadlock :)</p><p>See my implementation here: https://github.com/anurse/Oxygen/blob/dfda170b3f3d45eca20d4a1366e5d62384d7b2e4/src/vga.rs</p><p>Great posts by the way, loving the series!</p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"><div id="isso-202" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="666df3217240"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="20" y="12" width="8" height="8" style="fill: #9abf88"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Philipp Oppermann</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-202" class="permalink"><time title="Tue Jun 07 2016 22:00:03 GMT+0200 (Central European Summer Time)" datetime="2016-05-02T20:00:03Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>Thanks! I really like your solution. I wanted to fix the nested-println-deadlocks too, but totally forgot to do it‚Ä¶ However, the print_error solution also has advantages. For example, it always displays the error, even when we handle asynchronous hardware interrupts in the future.</p><p>So I think that I'd like to keep the print_error solution but also integrate your println changes (in order to fix deadlocks on nested printlns). I'm just not sure how to integrate it. Maybe I'll just add another section to the end of this post (just before `What's next`)‚Ä¶What do you think?</p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"></div></div></div><div id="isso-203" class="isso-comment isso-no-votes"><div class="avatar"><svg version="1.1" viewBox="0 0 48 48" preserveAspectRatio="xMinYMin meet" shape-rendering="crispEdges" data-hash="666df3217240"><rect x="0" y="0" width="56" height="56" style="fill: #f0f0f0"></rect><rect x="4" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="12" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="4" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="36" y="36" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="4" width="8" height="8" style="fill: #9abf88"></rect><rect x="12" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="28" y="28" width="8" height="8" style="fill: #9abf88"></rect><rect x="20" y="12" width="8" height="8" style="fill: #9abf88"></rect></svg></div><div class="text-wrapper"><div role="meta" class="isso-comment-header"><span class="author">Philipp Oppermann</span><span class="spacer">‚Ä¢</span><a rel="nofollow" href="index.html#isso-203" class="permalink"><time title="Tue Oct 25 2016 14:20:59 GMT+0200 (Central European Summer Time)" datetime="2016-09-02T12:20:59Z">vor 3 Jahren</time></a><span class="note"></span></div><div class="text"><p>I just thought about this again and I think I will switch to your solution. It's much cleaner and avoids the output data race completely. Thanks again for proposing it!</p><p>Edit: Implemented in <a rel="nofollow" href="https://github.com/phil-opp/blog_os/pull/249">#249</a></p></div><div class="isso-comment-footer"><span class="votes">0</span><a rel="nofollow" href="index.html#" class="upvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,18.299c-0.651-0.669-7.512-7.203-7.512-7.203C 16.912,10.739, 16.456,10.56, 16,10.56c-0.458,0-0.914,0.179-1.261,0.536 c0,0-6.861,6.534-7.514,7.203c-0.651,0.669-0.696,1.872,0,2.586c 0.698,0.712, 1.669,0.77, 2.522,0L 16,14.89l 6.251,5.995 c 0.854,0.77, 1.827,0.712, 2.522,0C 25.47,20.17, 25.427,18.966, 24.773,18.299z">
      </path>
    </g>
  </svg>
  </a><span class="spacer">|</span><a rel="nofollow" href="index.html#" class="downvote"><!-- Generator: IcoMoon.io --><svg width="16" height="16" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="gray">
    <g>
      <path d="M 24.773,13.701c-0.651,0.669-7.512,7.205-7.512,7.205C 16.912,21.262, 16.456,21.44, 16,21.44c-0.458,0-0.914-0.178-1.261-0.534 c0,0-6.861-6.536-7.514-7.205c-0.651-0.669-0.696-1.87,0-2.586c 0.698-0.714, 1.669-0.77, 2.522,0L 16,17.112l 6.251-5.995 c 0.854-0.77, 1.827-0.714, 2.522,0C 25.47,11.83, 25.427,13.034, 24.773,13.701z">
      </path>
    </g>
  </svg>
  </a><a rel="nofollow" href="index.html#" class="reply">Antworten</a></div><div class="isso-follow-up"></div></div></div></div></div></div></div>


    
</section>
    </section>

</div>

        <footer class="footer">
            <hr>
            <small>
                &copy; <time datetime="2017">2017</time>. All rights reserved.
                <a href="../contact/index.html">Contact</a>
            </small>
        </footer>
    </div>
</body>

</html>
