<!doctype html>

<html lang="fa">

<head>
    <meta charset="UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark">
    <meta name="description" content="ุญุงูุช ูุชู VGA ฺฉ ุฑูุด ุณุงุฏู ุจุฑุง ฺุงูพ ูุชู ุฑู ุตูุญู ุงุณุช. ุฏุฑ ุงู ูพุณุช ุ ุจุง ูุฑุงุฑ ุฏุงุฏู ููู ููุงุฑุฏ ุบุฑ ุงูู ุฏุฑ ฺฉ ูุงฺูู ุฌุฏุงฺฏุงูู ุ ุฑุงุจุท ุงุฌุงุฏ ู ฺฉูู ฺฉู ุงุณุชูุงุฏูโฆ">
    <meta name="author" content="Philipp Oppermann">

    
        <link rel="canonical" href="index.html" />
    
    <link href="../../css/edition-2/main.css" rel="stylesheet">

    <link rel="alternate" type="application/rss+xml" title="RSS feed for os.phil-opp.com" href="../../rss.xml" />

    <script>
        let theme = localStorage.getItem("theme");
        if (theme != null) {
            document.documentElement.setAttribute("data-theme", theme);
        }
    </script>

    <script async src="../../js/edition-2/main.js"></script>

    <title>ุญุงูุช ูุชู VGA | Writing an OS in Rust</title>
</head>

<body>
    <div class="container content">
        <header class="masthead">
            <div style="position:relative">
                <h2 class="masthead-title">
                    <a href="../../index.html" title="Home">Writing an OS in Rust</a>
                </h2>
                <p><small>Philipp&nbsp;Oppermann's&nbsp;blog</small></p>
                
    <aside id="all-posts-link"><a href="https://os.phil-opp.com/fa" title="All Posts">ยซ ููู ูพุณุชโูุง</a></aside>

            </div>
        </header>

        <div class="theme-switch">
            <div class="light-switch" onclick="toggle_lights()" title="Switch between light and dark theme"></div>
            <div class="light-switch-reset" onclick="clear_theme_override()" title="Clear the theme override and go back to the system theme"></div>
        </div>

        <div>
            
<aside id="toc-aside" class="right-to-left">
        <h2>ููุฑุณุช ูุทุงูุจ</h2>
    <ol>
        <li>
            <a href="index.html#bfr-mtn-vga">ุจุงูุฑ ูุชู VGA</a>
            
        </li><li>
            <a href="index.html#ykh-mjwl-rst">ฺฉ ูุงฺูู ุฑุงุณุช</a>
            <ol>
                <li>
                    <a href="index.html#rng-h">ุฑูฺฏ ูุง</a>
                </li><li>
                    <a href="index.html#bfr-mtn">ุจุงูุฑ ูุชู</a>
                </li><li>
                    <a href="index.html#chp-khrdn">ฺุงูพ ฺฉุฑุฏู</a>
                </li><li>
                    <a href="index.html#frwr">ูุฑูุงุฑ</a>
                </li><li>
                    <a href="index.html#mkhrwhy-qlbbndy">ูุงฺฉุฑูโูุง ูุงูุจโุจูุฏ</a>
                </li><li>
                    <a href="index.html#khtwt-jdyd">ุฎุทูุท ุฌุฏุฏ</a>
                </li>
            </ol>
        </li><li>
            <a href="index.html#ykh-rbt-glwbl">ฺฉ ุฑุงุจุท ฺฏููุจุงู</a>
            <ol>
                <li>
                    <a href="index.html#sttykhhy-tnbl-lazy-statics">ุงุณุชุงุชฺฉโูุง ุชูุจู (Lazy Statics)</a>
                </li><li>
                    <a href="index.html#spinlocks">Spinlocks</a>
                </li><li>
                    <a href="index.html#ymny">ุงูู</a>
                </li><li>
                    <a href="index.html#ykh-mkhrwy-println">ฺฉ ูุงฺฉุฑู println</a>
                </li><li>
                    <a href="index.html#hello-world-twst-println">Hello World ุชูุณุท println</a>
                </li><li>
                    <a href="index.html#chp-pym-hy-pnykh">ฺุงูพ ูพุงู ูุง ูพูฺฉ</a>
                </li>
            </ol>
        </li><li>
            <a href="index.html#khlsh">ุฎูุงุตู</a>
            
        </li><li>
            <a href="index.html#b-dy-chyst">ุจุนุฏ ฺุณุชุ</a>
            
        </li>
        <li class="toc-comments-link"><a href="index.html#comments">ูุธุฑุงุช</a></li>
    </ol>
</aside>

            <main>
    <div class="right-to-left">
    <h1>ุญุงูุช ูุชู VGA</h1>
    <time datetime="2018-02-26" class="post-date">
        Feb 26, 2018
        
    </time>
    </div>

    
        <div class="warning right-to-left">
            
            
            <p>
            <b>ูุญุชูุง ุชุฑุฌูู ุดุฏู:</b>
            ุงู ฺฉ ุชุฑุฌูู ุงุฒ ุฌุงูุนู ฺฉุงุฑุจุฑุงู ุจุฑุง ูพุณุช <strong><a href="../../vga-text-mode/index.html">VGA Text Mode</a></strong> ุงุณุช. ููฺฉู ุงุณุช ูุงูุตุ ููุณูุฎ ุดุฏู ุง ุฏุงุฑุง ุฎุทุง ุจุงุดุฏ. ูุทูุง ูุฑ ฺฏููู ูุดฺฉู ุฑุง ุฏุฑ <a href="https://github.com/phil-opp/blog_os/issues/908">ุงู ุงุดู</a> ฺฏุฒุงุฑุด ุฏูุฏ!
            </p>
            <p>
                ุชุฑุฌูู ุชูุณุท <a href="https://github.com/hamidrezakp">@hamidrezakp</a> ู <a href="https://github.com/MHBahrampour">@MHBahrampour</a>.</p>
            </div>
    

    <div class="right-to-left">
    <p><a href="https://en.wikipedia.org/wiki/VGA-compatible_text_mode">ุญุงูุช ูุชู VGA</a> ฺฉ ุฑูุด ุณุงุฏู ุจุฑุง ฺุงูพ ูุชู ุฑู ุตูุญู ุงุณุช. ุฏุฑ ุงู ูพุณุช ุ ุจุง ูุฑุงุฑ ุฏุงุฏู ููู ููุงุฑุฏ ุบุฑ ุงูู ุฏุฑ ฺฉ ูุงฺูู ุฌุฏุงฺฏุงูู ุ ุฑุงุจุท ุงุฌุงุฏ ู ฺฉูู ฺฉู ุงุณุชูุงุฏู ุงุฒ ุขู ุฑุง ุงูู ู ุณุงุฏู ู ฺฉูุฏ. ููฺูู ูพุดุชุจุงู ุงุฒ <a href="https://doc.rust-lang.org/std/fmt/#related-macros">ูุงฺฉุฑู ูุฑูุชโุจูุฏ</a> ุฑุงุณุช ุฑุง ูพุงุฏู ุณุงุฒ ูฺฉูู.</p>
<span id="continue-reading"></span>
<p>ุงู ุจูุงฺฏ ุจุตูุฑุช ุขุฒุงุฏ ุจุฑ ุฑู <a href="https://github.com/phil-opp/blog_os">ฺฏุชโูุงุจ</a> ุชูุณุนู ุฏุงุฏู ุดุฏู. ุงฺฏุฑ ูุดฺฉู ุง ุณูุงู ุฏุงุฑุฏุ ูุทูุง ุขูุฌุง ฺฉ ุงุดู ุจุงุฒ ฺฉูุฏ. ููฺูู ูโุชูุงูุฏ <a href="index.html#comments">ุฏุฑ ุฒุฑ</a> ุงู ูพุณุช ฺฉุงููุช ุจฺฏุฐุงุฑุฏ. ุณูุฑุณ ฺฉุฏ ฺฉุงูู ุงู ูพุณุช ุฑุง ู ุชูุงูุฏ ุฏุฑ ุดุงุฎู <a href="https://github.com/phil-opp/blog_os/tree/post-03"><code>post-01</code></a> ูพุฏุง ฺฉูุฏ.</p>
<!-- fix for zola anchor checker (target is in template): <a id="comments"> -->

    <details id = "toc-inline">
        <summary><b>ููุฑุณุช ูุทุงูุจ</b></summary>
        <ul>
            <li>
                <a href="index.html#bfr-mtn-vga">ุจุงูุฑ ูุชู VGA</a>
                
            </li><li>
                <a href="index.html#ykh-mjwl-rst">ฺฉ ูุงฺูู ุฑุงุณุช</a>
                <ul>
                    <li>
                        <a href="index.html#rng-h">ุฑูฺฏ ูุง</a>
                    </li><li>
                        <a href="index.html#bfr-mtn">ุจุงูุฑ ูุชู</a>
                    </li><li>
                        <a href="index.html#chp-khrdn">ฺุงูพ ฺฉุฑุฏู</a>
                    </li><li>
                        <a href="index.html#frwr">ูุฑูุงุฑ</a>
                    </li><li>
                        <a href="index.html#mkhrwhy-qlbbndy">ูุงฺฉุฑูโูุง ูุงูุจโุจูุฏ</a>
                    </li><li>
                        <a href="index.html#khtwt-jdyd">ุฎุทูุท ุฌุฏุฏ</a>
                    </li>
                </ul>
            </li><li>
                <a href="index.html#ykh-rbt-glwbl">ฺฉ ุฑุงุจุท ฺฏููุจุงู</a>
                <ul>
                    <li>
                        <a href="index.html#sttykhhy-tnbl-lazy-statics">ุงุณุชุงุชฺฉโูุง ุชูุจู (Lazy Statics)</a>
                    </li><li>
                        <a href="index.html#spinlocks">Spinlocks</a>
                    </li><li>
                        <a href="index.html#ymny">ุงูู</a>
                    </li><li>
                        <a href="index.html#ykh-mkhrwy-println">ฺฉ ูุงฺฉุฑู println</a>
                    </li><li>
                        <a href="index.html#hello-world-twst-println">Hello World ุชูุณุท println</a>
                    </li><li>
                        <a href="index.html#chp-pym-hy-pnykh">ฺุงูพ ูพุงู ูุง ูพูฺฉ</a>
                    </li>
                </ul>
            </li><li>
                <a href="index.html#khlsh">ุฎูุงุตู</a>
                
            </li><li>
                <a href="index.html#b-dy-chyst">ุจุนุฏ ฺุณุชุ</a>
                
            </li>
            <li class="toc-comments-link"><a href="index.html#comments">ูุธุฑุงุช</a></li>
        </ul>
    </details>

<h2 id="bfr-mtn-vga"><a class="zola-anchor" href="index.html#bfr-mtn-vga" aria-label="Anchor link for: bfr-mtn-vga">๐</a>ุจุงูุฑ ูุชู VGA</h2>
<p>ุจุฑุง ฺุงูพ ฺฉ ฺฉุงุฑุงฺฉุชุฑ ุฑู ุตูุญู ุฏุฑ ุญุงูุช ูุชู VGA ุ ุจุงุฏ ุขู ุฑุง ุฏุฑ ุจุงูุฑ ูุชู ุณุฎุช ุงูุฒุงุฑ VGA ุจููุณุฏ. ุจุงูุฑ ูุชู VGA ฺฉ ุขุฑุงู ุฏู ุจุนุฏ ุงุณุช ฺฉู ุจู ุทูุฑ ูุนููู 25 ุฑุฏู ู 80 ุณุชูู ุฏุงุฑุฏ ฺฉู ูุณุชููุงู ุจู ุตูุญู ููุงุด ุฏุงุฏู(ุฑูุฏุฑ) ู ุดูุฏ. ูุฑ ุฎุงูู ุขุฑุงู ฺฉ ฺฉุงุฑุงฺฉุชุฑ ุตูุญู ููุงุด ุฑุง ุงุฒ ุทุฑู ูุงูุจ ุฒุฑ ุชูุตู ู ฺฉูุฏ:</p>
<table><thead><tr><th>Bit(s)</th><th>Value</th></tr></thead><tbody>
<tr><td>0-7</td><td>ASCII code point</td></tr>
<tr><td>8-11</td><td>Foreground color</td></tr>
<tr><td>12-14</td><td>Background color</td></tr>
<tr><td>15</td><td>Blink</td></tr>
</tbody></table>
<p>ุงููู ุจุงุช ฺฉุงุฑุงฺฉุชุฑ ุฏุฑ <a href="https://en.wikipedia.org/wiki/ASCII">ฺฉุฏฺฏุฐุงุฑ ASCII</a> ุฑุง ูุดุงู ู ุฏูุฏ ฺฉู ุจุงุฏ ฺุงูพ ุดูุฏ. ุงฺฏุฑ ุจุฎูุงูู ุฏูู ุจุงุดู ุ ุฏููุงู ASCII ูุณุช ุ ุจูฺฉู ูุฌููุนู ุง ุงุฒ ฺฉุงุฑุงฺฉุชุฑูุง ุจู ูุงู <a href="https://en.wikipedia.org/wiki/Code_page_437"><em>ฺฉุฏ ุตูุญู 437</em></a> ุจุง ุจุฑุฎ ฺฉุงุฑุงฺฉุชุฑ ูุง ุงุถุงู ู ุชุบุฑุงุช ุฌุฒุฆ ุงุณุช. ุจุฑุง ุณุงุฏฺฏ ุ ูุง ุฏุฑ ุงู ูพุณุช ุขูุฑุง ฺฉ ฺฉุงุฑุงฺฉุชุฑ ASCII ู ูุงูู.</p>
<p>ุจุงุช ุฏูู ูุญูู ููุงุด ฺฉุงุฑุงฺฉุชุฑ ุฑุง ูุดุฎุต ู ฺฉูุฏ. ฺูุงุฑ ุจุช ุงูู ุฑูฺฏ ูพุด ุฒููู ุฑุง ูุดุฎุต ู ฺฉูุฏ ุ ุณู ุจุช ุจุนุฏ ุฑูฺฏ ูพุณ ุฒููู ู ุจุช ุขุฎุฑ ุงูฺฉู ฺฉุงุฑุงฺฉุชุฑ ุจุงุฏ ฺุดูฺฉ ุจุฒูุฏ ุง ูู. ุฑูฺฏ ูุง ุฒุฑ ููุฌูุฏ ุงุณุช:</p>
<table><thead><tr><th>Number</th><th>Color</th><th>Number + Bright Bit</th><th>Bright Color</th></tr></thead><tbody>
<tr><td>0x0</td><td>Black</td><td>0x8</td><td>Dark Gray</td></tr>
<tr><td>0x1</td><td>Blue</td><td>0x9</td><td>Light Blue</td></tr>
<tr><td>0x2</td><td>Green</td><td>0xa</td><td>Light Green</td></tr>
<tr><td>0x3</td><td>Cyan</td><td>0xb</td><td>Light Cyan</td></tr>
<tr><td>0x4</td><td>Red</td><td>0xc</td><td>Light Red</td></tr>
<tr><td>0x5</td><td>Magenta</td><td>0xd</td><td>Pink</td></tr>
<tr><td>0x6</td><td>Brown</td><td>0xe</td><td>Yellow</td></tr>
<tr><td>0x7</td><td>Light Gray</td><td>0xf</td><td>White</td></tr>
</tbody></table>
<p>ุจุช 4ุ ุจุช ุฑูุดูุง ุงุณุช ุ ฺฉู ุจู ุนููุงู ูุซุงู ุขุจ ุจู ุขุจ ุฑูุดู ุชุจุฏู ูโฺฉูุฏ. ุจุฑุง ุฑูฺฏ ูพุณ ุฒููู ุ ุงู ุจุช ุจู ุนููุงู ุจุช ฺุดูฺฉ ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ู ฺฏุฑุฏ.</p>
<p>ุจุงูุฑ ูุชู VGA ุงุฒ ุทุฑู <a href="https://en.wikipedia.org/wiki/Memory-mapped_I/O">ูุฑูุฏ/ุฎุฑูุฌ ุญุงูุธูโูฺฏุงุดุช</a> ุจู ุขุฏุฑุณ<code>0xb8000</code> ูุงุจู ุฏุณุชุฑุณ ุงุณุช. ุงู ุจุฏุงู ูุนู ุงุณุช ฺฉู ุฎูุงูุฏู ู ููุดุชู ุฏุฑ ุขู ุขุฏุฑุณ ุจู RAM ุฏุณุชุฑุณ ูุฏุงุฑุฏ ุ ุจูฺฉู ูุณุชููุงู ุฏุณุชุฑุณ ุจู ุจุงูุฑ ูุชู ุฏุฑ ุณุฎุช ุงูุฒุงุฑ VGA ุฏุงุฑุฏ. ุงู ุจุฏุงู ูุนู ุงุณุช ฺฉู ู ุชูุงูู ุขู ุฑุง ุงุฒ ุทุฑู ุนููุงุช ุญุงูุธู ุนุงุฏ ุฏุฑ ุขู ุขุฏุฑุณ ุจุฎูุงูู ู ุจููุณู.</p>
<p>ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ููฺฉู ุงุณุช ุณุฎุช ุงูุฒุงุฑ ุญุงูุธูโูฺฏุงุดุช ุดุฏู ุงุฒ ุชูุงู ุนููุงุช ูุนููู RAM ูพุดุชุจุงู ูฺฉูุฏ. ุจู ุนููุงู ูุซุงู ุ ฺฉ ุฏุณุชฺฏุงู ููฺฉู ุงุณุช ููุท ุฎูุงูุฏู ุจุงุช ุฑุง ูพุดุชุจุงู ฺฉุฑุฏู ู ุจุง ุฎูุงูุฏู <code>u64</code> ฺฉ ููุฏุงุฑ ุฒุจุงูู ุฑุง ุจุฑฺฏุฑุฏุงูุฏ. ุฎูุดุจุฎุชุงูู ุจุงูุฑ ูุชู <a href="https://web.stanford.edu/class/cs140/projects/pintos/specs/freevga/vga/vgamem.htm#manip">ุงุฒ ุฎูุงูุฏู ู ููุดุชู ุนุงุฏ ูพุดุชุจุงู ู ฺฉูุฏ</a> ุ ุจูุงุจุฑุงู ูุฌุจูุฑ ูุณุชู ุจุง ุขู ุจู ุฑูุด ุฎุงุต ุจุฑุฎูุฑุฏ ฺฉูู.</p>
<h2 id="ykh-mjwl-rst"><a class="zola-anchor" href="index.html#ykh-mjwl-rst" aria-label="Anchor link for: ykh-mjwl-rst">๐</a>ฺฉ ูุงฺูู ุฑุงุณุช</h2>
<p>ุงฺฉููู ฺฉู ุงุฒ ูุญูู ฺฉุงุฑ ุจุงูุฑ VGA ูุทูุน ุดุฏู ุ ู ุชูุงูู ฺฉ ูุงฺูู Rust ุจุฑุง ูุฏุฑุช ฺุงูพ ุงุฌุงุฏ ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">//โฏin src/main.rs
</span><span style="color:#569cd6;">mod </span><span>vga_buffer;
</span></code></pre>
<p>ุจุฑุง ูุญุชูุง ุงู ูุงฺูู ูุง ฺฉ ูุงู ุฌุฏุฏ <code>src/vga_buffer.rs</code> ุงุฌุงุฏ ู ฺฉูู. ููู ฺฉุฏูุง ุฒุฑ ูุงุฑุฏ ูุงฺูู ุฌุฏุฏ ูุง ู ุดููุฏ (ูฺฏุฑ ุงูฺฉู ุทูุฑ ุฏฺฏุฑ ูุดุฎุต ุดุฏู ุจุงุดุฏ).</p>
<h3 id="rng-h"><a class="zola-anchor" href="index.html#rng-h" aria-label="Anchor link for: rng-h">๐</a>ุฑูฺฏ ูุง</h3>
<p>ุงูู ุ ูุง ุฑูฺฏ ูุง ูุฎุชูู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ enum ูุดุงู ู ุฏูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span>#[allow(dead_code)]
</span><span>#[derive(Debug, Clone, Copy, PartialEq, Eq)]
</span><span>#[repr(u8)]
</span><span style="color:#569cd6;">pub enum </span><span>Color {
</span><span>    Black = </span><span style="color:#b5cea8;">0</span><span>,
</span><span>    Blue = </span><span style="color:#b5cea8;">1</span><span>,
</span><span>    Green = </span><span style="color:#b5cea8;">2</span><span>,
</span><span>    Cyan = </span><span style="color:#b5cea8;">3</span><span>,
</span><span>    Red = </span><span style="color:#b5cea8;">4</span><span>,
</span><span>    Magenta = </span><span style="color:#b5cea8;">5</span><span>,
</span><span>    Brown = </span><span style="color:#b5cea8;">6</span><span>,
</span><span>    LightGray = </span><span style="color:#b5cea8;">7</span><span>,
</span><span>    DarkGray = </span><span style="color:#b5cea8;">8</span><span>,
</span><span>    LightBlue = </span><span style="color:#b5cea8;">9</span><span>,
</span><span>    LightGreen = </span><span style="color:#b5cea8;">10</span><span>,
</span><span>    LightCyan = </span><span style="color:#b5cea8;">11</span><span>,
</span><span>    LightRed = </span><span style="color:#b5cea8;">12</span><span>,
</span><span>    Pink = </span><span style="color:#b5cea8;">13</span><span>,
</span><span>    Yellow = </span><span style="color:#b5cea8;">14</span><span>,
</span><span>    White = </span><span style="color:#b5cea8;">15</span><span>,
</span><span>}
</span></code></pre>
<p>ูุง ุฏุฑ ุงูุฌุง ุงุฒ <a href="https://doc.rust-lang.org/rust-by-example/custom_types/enum/c_like.html">enum ูุงููุฏ C</a> ุจุฑุง ูุดุฎุต ฺฉุฑุฏู ุตุฑุญ ุนุฏุฏ ุจุฑุง ูุฑ ุฑูฺฏ ุงุณุชูุงุฏู ู ฺฉูู. ุจู ุฏูู ูฺฺฏ <code>repr(u8)</code> ูุฑ ููุน enum ุจู ุนููุงู ฺฉ <code>u8</code> ุฐุฎุฑู ู ุดูุฏ. ุฏุฑ ูุงูุน 4 ุจุช ฺฉุงู ุงุณุช ุ ุงูุง Rust ููุน <code>u4</code> ูุฏุงุฑุฏ.</p>
<p>ุจู ุทูุฑ ูุนููู ฺฉุงููพุงูุฑ ุจุฑุง ูุฑ ููุน ุงุณุชูุงุฏู ูุดุฏู ุงุฎุทุงุฑ ู ุฏูุฏ. ุจุง ุงุณุชูุงุฏู ุงุฒ ูฺฺฏ <code>#[allow(dead_code)]</code> ุงู ูุดุฏุงุฑูุง ุฑุง ุจุฑุง enum <code>Color</code> ุบุฑูุนุงู ู ฺฉูู.</p>
<p>ุชูุณุท <a href="https://doc.rust-lang.org/rust-by-example/trait/derive.html">deriving</a> ฺฉุฑุฏู ุชุฑุชโูุง  <a href="https://doc.rust-lang.org/nightly/core/marker/trait.Copy.html"><code>Copy</code></a>, <a href="https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html"><code>Clone</code></a>, <a href="https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html"><code>Debug</code></a>, <a href="https://doc.rust-lang.org/nightly/core/cmp/trait.PartialEq.html"><code>PartialEq</code></a>, ู <a href="https://doc.rust-lang.org/nightly/core/cmp/trait.Eq.html"><code>Eq</code></a> ูุง <a href="https://doc.rust-lang.org/1.30.0/book/first-edition/ownership.html#copy-types">ููููู ฺฉูพ</a> ุฑุง ุจุฑุง ููุน ูุนุงู ฺฉุฑุฏู ู ุขู ุฑุง ูุงุจู ูพุฑูุช ฺฉุฑุฏู ูฺฉูู.</p>
<p>ุจุฑุง ูุดุงู ุฏุงุฏู ฺฉ ฺฉุฏ ฺฉุงูู ุฑูฺฏ ฺฉู ุฑูฺฏ ูพุด ุฒููู ู ูพุณ ุฒููู ุฑุง ูุดุฎุต ู ฺฉูุฏ ุ ฺฉ <a href="https://doc.rust-lang.org/rust-by-example/generics/new_types.html">ููุน ุฌุฏุฏ</a> ุจุฑ ุฑู <code>u8</code> ุงุฌุงุฏ ู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span>#[derive(Debug, Clone, Copy, PartialEq, Eq)]
</span><span>#[repr(transparent)]
</span><span style="color:#569cd6;">struct </span><span>ColorCode(</span><span style="color:#569cd6;">u8</span><span>);
</span><span>
</span><span style="color:#569cd6;">impl </span><span>ColorCode {
</span><span>    </span><span style="color:#569cd6;">fn </span><span>new(foreground: Color, background: Color) -&gt; ColorCode {
</span><span>        ColorCode((background </span><span style="color:#569cd6;">as u8</span><span>) &lt;&lt; </span><span style="color:#b5cea8;">4 </span><span style="color:#569cd6;">| </span><span>(foreground </span><span style="color:#569cd6;">as u8</span><span>))
</span><span>    }
</span><span>}
</span></code></pre>
<p>ุณุงุฎุชูุงู <code>ColorCode</code> ุดุงูู ุจุงุช ฺฉุงูู ุฑูฺฏ ุงุณุช ฺฉู ุดุงูู ุฑูฺฏ ูพุด ุฒููู ู ูพุณ ุฒููู ุงุณุช. ูุงููุฏ ูุจู ุ ูฺฺฏ ูุง <code>Copy</code> ู<code> Debug</code> ุฑุง ุจุฑุง ุขู derive ู ฺฉูู. ุจุฑุง ุงุทููุงู ุงุฒ ุงูฺฉู <code>ColorCode</code> ุฏููุงู ุณุงุฎุชุงุฑ ุฏุงุฏู ูุดุงุจู <code>u8</code> ุฏุงุฑุฏ ุ ุงุฒ ูฺฺฏ <a href="https://doc.rust-lang.org/nomicon/other-reprs.html#reprtransparent"><code>repr(transparent)</code></a> ุงุณุชูุงุฏู ู ฺฉูู.</p>
<h3 id="bfr-mtn"><a class="zola-anchor" href="index.html#bfr-mtn" aria-label="Anchor link for: bfr-mtn">๐</a>ุจุงูุฑ ูุชู</h3>
<p>ุงฺฉููู ู ุชูุงูู ุณุงุฎุชูุงูโูุง ุฑุง ุจุฑุง ููุงุด ฺฉ ฺฉุงุฑุงฺฉุชุฑ ุตูุญู ู ุจุงูุฑ ูุชู ุงุถุงูู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span>#[derive(Debug, Clone, Copy, PartialEq, Eq)]
</span><span>#[repr(C)]
</span><span style="color:#569cd6;">struct </span><span>ScreenChar {
</span><span>    ascii_character: </span><span style="color:#569cd6;">u8</span><span>,
</span><span>    color_code: ColorCode,
</span><span>}
</span><span>
</span><span style="color:#569cd6;">const </span><span style="color:#b4cea8;">BUFFER_HEIGHT</span><span>: </span><span style="color:#569cd6;">usize </span><span>= </span><span style="color:#b5cea8;">25</span><span>;
</span><span style="color:#569cd6;">const </span><span style="color:#b4cea8;">BUFFER_WIDTH</span><span>: </span><span style="color:#569cd6;">usize </span><span>= </span><span style="color:#b5cea8;">80</span><span>;
</span><span>
</span><span>#[repr(transparent)]
</span><span style="color:#569cd6;">struct </span><span>Buffer {
</span><span>    chars: [[ScreenChar; BUFFER_WIDTH]; BUFFER_HEIGHT],
</span><span>}
</span></code></pre>
<p>ุงุฒ ุขูุฌุง ฺฉู ุชุฑุชุจ ููุฏูุง ุณุงุฎุชูุงูโูุง ูพุด ูุฑุถ ุฏุฑ Rust ุชุนุฑู ูุดุฏู ุงุณุช ุ ุจู ูฺฺฏ<a href="https://doc.rust-lang.org/nightly/nomicon/other-reprs.html#reprc"><code>repr(C)</code></a> ูุงุฒ ุฏุงุฑู. ุงู ุชุถูู ู ฺฉูุฏ ฺฉู ููุฏ ูุง ุณุงุฎุชูุงู ุฏููุงู ูุงููุฏ ฺฉ ุณุงุฎุชูุงู C ุชุฑุณู ุดุฏู ุงูุฏ ู ุจูุงุจุฑุงู ุชุฑุชุจ ุฏุฑุณุช ุฑุง ุชุถูู ู ฺฉูุฏ. ุจุฑุง ุณุงุฎุชูุงู <code>Buffer</code> ุ ูุง ุฏูุจุงุฑู ุงุฒ <a href="https://doc.rust-lang.org/nomicon/other-reprs.html#reprtransparent"><code>repr(transparent)</code></a> ุงุณุชูุงุฏู ู ฺฉูู ุชุง ุงุทููุงู ุญุงุตู ุดูุฏ ฺฉู ูุญูู ูุฑุงุฑฺฏุฑ ุฏุฑ ุญุงูุธู ุฏููุง ููุงู ฺฉ ููุฏ ุงุณุช.</p>
<p>ุจุฑุง ููุดุชู ุฏุฑ ุตูุญู ุ ุงฺฉููู ฺฉ ููุน ููุณูุฏู ุงุฌุงุฏ ู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span style="color:#569cd6;">pub struct </span><span>Writer {
</span><span>    column_position: </span><span style="color:#569cd6;">usize</span><span>,
</span><span>    color_code: ColorCode,
</span><span>    buffer: </span><span style="color:#569cd6;">&amp;&#39;static mut</span><span> Buffer,
</span><span>}
</span></code></pre>
<p>ููุณูุฏู ููุดู ุฏุฑ ุขุฎุฑู ุฎุท ูููุณุฏ ู ููุช ุฎุท ูพุฑ ุงุณุช (ุง ุฏุฑ <code>\n</code>) ุ ุณุทุฑูุง ุฑุง ุจู ุณูุช ุจุงูุง ุดูุช ู ุฏูุฏ. ููุฏ <code>column_position</code> ูููุนุช ูุนู ุฏุฑ ุฑุฏู ุขุฎุฑ ุฑุง ูฺฏูุฏุงุฑ ู ฺฉูุฏ. ุฑูฺฏูุง ูพุด ุฒููู ู ูพุณ ุฒููู ูุนู ุชูุณุท <code>color_code</code> ูุดุฎุต ุดุฏู ู ฺฉ ุงุฑุฌุงุน (ุฑูุฑูุณ) ุจู ุจุงูุฑ VGA ุฏุฑ <code>buffer</code> ุฐุฎุฑู ู ุดูุฏ. ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ูุง ุฏุฑ ุงูุฌุง ุจู <a href="https://doc.rust-lang.org/book/ch10-03-lifetime-syntax.html#lifetime-annotation-syntax">ุทูู ุนูุฑ ูุดุฎุต</a> ูุงุฒ ุฏุงุฑู ุชุง ุจู ฺฉุงููพุงูุฑ ุจฺฏูู ุชุง ฺู ูุฏุช ุงู ุงุฑุฌุงุน ูุนุชุจุฑ ุงุณุช. ุธูู ุนูุฑ <a href="https://doc.rust-lang.org/book/ch10-03-lifetime-syntax.html#the-static-lifetime"><code>'static</code></a> ูุดุฎุต ู ฺฉูุฏ ฺฉู ุงุฑุฌุงุน ุจุฑุง ฺฉู ูุฏุช ุฒูุงู ุงุฌุฑุง ุจุฑูุงูู ูุนุชุจุฑ ุจุงุดุฏ (ฺฉู ุจุฑุง ุจุงูุฑ ูุชู VGA ุฏุฑุณุช ุงุณุช).</p>
<h3 id="chp-khrdn"><a class="zola-anchor" href="index.html#chp-khrdn" aria-label="Anchor link for: chp-khrdn">๐</a>ฺุงูพ ฺฉุฑุฏู</h3>
<p>ุงฺฉููู ู ุชูุงูู ุงุฒ <code>Writer</code> ุจุฑุง ุชุบุฑ ฺฉุงุฑุงฺฉุชุฑูุง ุจุงูุฑ ุงุณุชูุงุฏู ฺฉูู. ุงุจุชุฏุง ฺฉ ูุชุฏ ุจุฑุง ููุดุชู ฺฉ ุจุงุช ASCII ุงุฌุงุฏ ู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span style="color:#569cd6;">impl </span><span>Writer {
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>write_byte(</span><span style="color:#569cd6;">&amp;mut </span><span>self, byte: </span><span style="color:#569cd6;">u8</span><span>) {
</span><span>        </span><span style="color:#569cd6;">match</span><span> byte {
</span><span>            </span><span style="color:#569cd6;">b</span><span style="color:#d69d85;">&#39;</span><span style="color:#e3bbab;">\n</span><span style="color:#d69d85;">&#39; </span><span style="color:#569cd6;">=&gt; </span><span>self.new_line(),
</span><span>            byte </span><span style="color:#569cd6;">=&gt; </span><span>{
</span><span>                </span><span style="color:#569cd6;">if </span><span>self.column_position &gt;= </span><span style="color:#b4cea8;">BUFFER_WIDTH </span><span>{
</span><span>                    self.new_line();
</span><span>                }
</span><span>
</span><span>                </span><span style="color:#569cd6;">let</span><span> row = </span><span style="color:#b4cea8;">BUFFER_HEIGHT </span><span>- </span><span style="color:#b5cea8;">1</span><span>;
</span><span>                </span><span style="color:#569cd6;">let</span><span> col = self.column_position;
</span><span>
</span><span>                </span><span style="color:#569cd6;">let</span><span> color_code = self.color_code;
</span><span>                self.buffer.chars[row][col] = ScreenChar {
</span><span>                    ascii_character: byte,
</span><span>                    color_code,
</span><span>                };
</span><span>                self.column_position += </span><span style="color:#b5cea8;">1</span><span>;
</span><span>            }
</span><span>        }
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#569cd6;">fn </span><span>new_line(</span><span style="color:#569cd6;">&amp;mut </span><span>self) {</span><span style="color:#608b4e;">/* TODO */</span><span>}
</span><span>}
</span></code></pre>
<p>ุงฺฏุฑ ุจุงุชุ ุจุงุชู <a href="https://en.wikipedia.org/wiki/Newline">ุฎุท ุฌุฏุฏ</a> <code>\n</code> ุจุงุดุฏุ ููุณูุฏู ฺุฒ ฺุงูพ ูู ฺฉูุฏ. ุฏุฑ ุนูุถ ูุชุฏ <code>new_line</code> ุฑุง ูุฑุงุฎูุงู ู ฺฉูุฏ ฺฉู ุจุนุฏุงู ุขู ุฑุง ูพุงุฏูโุณุงุฒ ุฎูุงูู ฺฉุฑุฏ. ุจุงุช ูุง ุฏฺฏุฑ ุฏุฑ ุญุงูุช ุฏูู match ุฑู ุตูุญู ฺุงูพ ู ุดููุฏ.</p>
<p>ููฺฏุงู ฺุงูพ ุจุงุช ุ ููุณูุฏู ุจุฑุฑุณ ู ฺฉูุฏ ฺฉู ุขุง ุฎุท ูุนู ูพุฑ ุงุณุช ุง ูู. ุฏุฑ ุตูุฑุช ูพูุฑ ุจูุฏูุ ุจุฑุง ููุดุชู ุฏุฑ ุฎุท ุ ุจุงุฏ ูุชุฏ <code>new_line</code> ุตุฏุง ุฒุฏู ุดูุฏ. ุณูพุณ ฺฉ <code>ScreenChar</code> ุฌุฏุฏ ุฏุฑ ุจุงูุฑ ุฏุฑ ูููุนุช ูุนู ู ููุณุฏ. ุณุฑุงูุฌุงู ุ ูููุนุช ุณุชูู ูุนู ฺฉ ุงูุฒุงุด ูโุงุจุฏ.</p>
<p>ุจุฑุง ฺุงูพ ฺฉู ุฑุดุชู ูุงุ ู ุชูุงูู ุขููุง ุฑุง ุจู ุจุงุช ุชุจุฏู ฺฉุฑุฏู ู ฺฉ ฺฉ ฺุงูพ ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span style="color:#569cd6;">impl </span><span>Writer {
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>write_string(</span><span style="color:#569cd6;">&amp;mut </span><span>self, s: </span><span style="color:#569cd6;">&amp;str</span><span>) {
</span><span>        </span><span style="color:#569cd6;">for</span><span> byte </span><span style="color:#569cd6;">in</span><span> s.bytes() {
</span><span>            </span><span style="color:#569cd6;">match</span><span> byte {
</span><span>                </span><span style="color:#608b4e;">// printable ASCII byte or newline
</span><span>                </span><span style="color:#b5cea8;">0x20</span><span style="color:#569cd6;">..</span><span>=</span><span style="color:#b5cea8;">0x7e </span><span style="color:#569cd6;">| b</span><span style="color:#d69d85;">&#39;</span><span style="color:#e3bbab;">\n</span><span style="color:#d69d85;">&#39; </span><span style="color:#569cd6;">=&gt; </span><span>self.write_byte(byte),
</span><span>                </span><span style="color:#608b4e;">// not part of printable ASCII range
</span><span>                </span><span style="color:#569cd6;">_ =&gt; </span><span>self.write_byte(</span><span style="color:#b5cea8;">0xfe</span><span>),
</span><span>            }
</span><span>
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre>
<p>ุจุงูุฑ ูุชู VGA ููุท ุงุฒ ASCII ู ุจุงุช ูุง ุงุถุงู <a href="https://en.wikipedia.org/wiki/Code_page_437">ฺฉุฏ ุตูุญู 437</a> ูพุดุชุจุงู ู ฺฉูุฏ. ุฑุดุชู ูุง ุฑุงุณุช ุจู ุทูุฑ ูพุด ูุฑุถ <a href="https://www.fileformat.info/info/unicode/utf8.htm">UTF-8</a> ูุณุชูุฏ ุ ุจูุงุจุฑุงู ููฺฉู ุงุณุช ุญุงู ุจุงุช ูุง ุจุงุดูุฏ ฺฉู ุชูุณุท ุจุงูุฑ ูุชู VGA ูพุดุชุจุงู ูู ุดููุฏ. ูุง ุงุฒ ฺฉ match ุจุฑุง ุชูฺฉฺฉ ุจุงุช ูุง ูุงุจู ฺุงูพ ASCII (ฺฉ ุฎุท ุฌุฏุฏ ุง ูุฑ ฺุฒ ุฏฺฏุฑ ุจู ฺฉ ฺฉุงุฑุงฺฉุชุฑ ูุงุตูู ู ฺฉ ฺฉุงุฑุงฺฉุชุฑ<code>~</code>) ู ุจุงุช ูุง ุบุฑ ูุงุจู ฺุงูพ ุงุณุชูุงุฏู ู ฺฉูู. ุจุฑุง ุจุงุช ูุง ุบุฑ ูุงุจู ฺุงูพ ุ ฺฉ ฺฉุงุฑุงฺฉุชุฑ <code>โ</code> ฺุงูพ ู ฺฉูู ฺฉู ุฏุงุฑุง ฺฉุฏ ุดุงูุฒุฏูโุง (hex) <code>0xfe</code> ุจุฑ ุฑู ุณุฎุช ุงูุฒุงุฑ VGA ุงุณุช.</p>
<h4 id="mthnsh-khnyd"><a class="zola-anchor" href="index.html#mthnsh-khnyd" aria-label="Anchor link for: mthnsh-khnyd">๐</a>ุงูุชุญุงูโุงุด ฺฉูุฏ!</h4>
<p>ุจุฑุง ููุดุชู ฺูุฏ ฺฉุงุฑุงฺฉุชุฑ  ุจุฑ ุฑู ุตูุญู ุ ู ุชูุงูุฏ ฺฉ ุชุงุจุน ูููุช ุงุฌุงุฏ ฺฉูุฏ:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span style="color:#569cd6;">pub fn </span><span>print_something() {
</span><span>    </span><span style="color:#569cd6;">let mut</span><span> writer = Writer {
</span><span>        column_position: </span><span style="color:#b5cea8;">0</span><span>,
</span><span>        color_code: ColorCode::new(Color::Yellow, Color::Black),
</span><span>        buffer: </span><span style="color:#569cd6;">unsafe </span><span>{ </span><span style="color:#569cd6;">&amp;mut </span><span>*(</span><span style="color:#b5cea8;">0xb8000 </span><span style="color:#569cd6;">as *mut</span><span> Buffer) },
</span><span>    };
</span><span>
</span><span>    writer.write_byte(</span><span style="color:#569cd6;">b</span><span style="color:#d69d85;">&#39;H&#39;</span><span>);
</span><span>    writer.write_string(</span><span style="color:#d69d85;">&quot;ello &quot;</span><span>);
</span><span>    writer.write_string(</span><span style="color:#d69d85;">&quot;Wรถrld!&quot;</span><span>);
</span><span>}
</span></code></pre>
<p>ุงุจุชุฏุง ฺฉ Writer ุฌุฏุฏ ุงุฌุงุฏ ู ฺฉูุฏ ฺฉู ุจู ุจุงูุฑ VGA ุฏุฑ <code>0xb8000</code> ุงุดุงุฑู ุฏุงุฑุฏ. ุณูุชฺฉุณ ุงู ููฺฉู ุงุณุช ฺฉู ุนุฌุจ ุจู ูุธุฑ ุจุฑุณุฏ: ุงูู ุ ูุง ุนุฏุฏ ุตุญุญ <code>0xb8000</code> ุฑุง ุจู ุนููุงู <a href="https://doc.rust-lang.org/book/ch19-01-unsafe-rust.html#dereferencing-a-raw-pointer">ุงุดุงุฑู ฺฏุฑ ุฎุงู</a> ูุงุจู ุชุบุฑ ุฏุฑ ูุธุฑ ู ฺฏุฑู. ุณูพุณ ุจุง dereferencing ฺฉุฑุฏู ุขู (ุงุฒ ุทุฑู โ*โ) ู ุจูุงูุงุตูู ุงุฑุฌุงุน ูุฌุฏุฏ (ุงุฒ ุทุฑู <code>&amp;mut</code>) ุขู ุฑุง ุจู ฺฉ ูุฑุฌุน ูุงุจู ุชุบุฑ ุชุจุฏู ู ฺฉูู. ุงู ุชุจุฏู ุจู ฺฉ <a href="https://doc.rust-lang.org/book/ch19-01-unsafe-rust.html">ุจููฺฉ <code>ุบุฑุงูู</code></a> ุงุญุชุงุฌ ุฏุงุฑุฏ ุ ุฒุฑุง ฺฉุงููพุงูุฑ ูู ุชูุงูุฏ ุตุญุช ุงุดุงุฑูโฺฏุฑ ุฎุงู ุฑุง ุชุถูู ฺฉูุฏ.</p>
<p>ุณูพุณ ุจุงุช <code>b'H'</code> ุฑุง ุฑู ุขู ู ููุณุฏ. ูพุดููุฏ <code>b</code> ฺฉ <a href="https://doc.rust-lang.org/reference/tokens.html#byte-literals">ุจุงุช ูุชุฑุงู</a> ุงุฌุงุฏ ู ฺฉูุฏ ุ ฺฉู ุจุงูฺฏุฑ ฺฉ ฺฉุงุฑุงฺฉุชุฑ ASCII ุงุณุช. ุจุง ููุดุชู ุฑุดุชู ูุง <code>&quot;ello &quot;</code> ู <code>&quot;Wรถrld!&quot;</code> ุ ูุง ูุชุฏ <code>write_string</code> ู ูุงฺฉูุด ุจู ฺฉุงุฑุงฺฉุชุฑูุง ุบุฑ ูุงุจู ฺุงูพ ุฑุง ุขุฒูุงุด ู ฺฉูู. ุจุฑุง ุฏุฏู ุฎุฑูุฌ ุ ุจุงุฏ ุชุงุจุน <code>print_something</code> ุฑุง ุงุฒ ุชุงุจุน <code>_start</code> ูุฑุงุฎูุงู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/main.rs
</span><span>
</span><span>#[no_mangle]
</span><span style="color:#569cd6;">pub extern </span><span style="color:#d69d85;">&quot;C&quot; </span><span style="color:#569cd6;">fn </span><span>_start() -&gt; </span><span style="color:#569cd6;">! </span><span>{
</span><span>    vga_buffer::print_something();
</span><span>
</span><span>    </span><span style="color:#569cd6;">loop </span><span>{}
</span><span>}
</span></code></pre>
<p>ุงฺฉููู ููฺฏุงู ฺฉู ูุง ูพุฑูฺู ุฑุง ุงุฌุฑุง ู ฺฉูู ุ ุจุงุฏ ฺฉ <code>Hello Wโโrld!</code> ุฏุฑ ฺฏูุดู ุณูุช ฺูพ <em>ูพุงู</em> ุตูุญู ุจู ุฑูฺฏ ุฒุฑุฏ ฺุงูพ ุดูุฏ:</p>
<p><img src="vga-hello.png" alt="QEMU output with a yellow Hello Wโโrld! in the lower left corner" /></p>
<p>ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู <code>รถ</code> ุจู ุนููุงู ุฏู ฺฉุงุฑุงฺฉุชุฑ <code>โ</code> ฺุงูพ ุดุฏู ุงุณุช. ุจู ุงู ุฏูู ฺฉู <code>รถ</code> ุจุง ุฏู ุจุงุช ุฏุฑ <a href="https://www.fileformat.info/info/unicode/utf8.htm">UTF-8</a> ููุงุด ุฏุงุฏู ู ุดูุฏ ุ ฺฉู ูุฑ ุฏู ุฏุฑ ูุญุฏูุฏู ูุงุจู ฺุงูพ ASCII ูุฑุงุฑ ูู ฺฏุฑูุฏ. ุฏุฑ ุญููุช ุ ุงู ฺฉ ูฺฺฏ ุงุณุงุณ UTF-8 ุงุณุช: ูุฑ ุจุงุช ุงุฒ ููุงุฏุฑ ฺูุฏ ุจุงุช ูุฑฺฏุฒ ASCII ูุนุชุจุฑ ูุณุชูุฏ.</p>
<h3 id="frwr"><a class="zola-anchor" href="index.html#frwr" aria-label="Anchor link for: frwr">๐</a>ูุฑูุงุฑ</h3>
<p>ูุง ุงูุงู ุฏุฏู ฺฉู ูพุงู ูุง ุจู ุฏุฑุณุช ฺุงูพ ุดุฏู ุงุณุช. ุจุง ุงู ุญุงู ุ ููฺฉู ุงุณุช ุจุง ฺฉุงููพุงูุฑูุง ุขูุฏู Rust ฺฉู ุจู ุตูุฑุช ุชูุงุฌู ุชุฑ(aggressively) ุจููู ู ุดููุฏ ุ ฺฉุงุฑ ูฺฉูุฏ.</p>
<p>ูุดฺฉู ุงู ุงุณุช ฺฉู ูุง ููุท ุจู <code>Buffer</code> ู ููุณู ู ูุฑฺฏุฒ ุงุฒ ุขู ููุฎูุงูู. ฺฉุงููพุงูุฑ ูู ุฏุงูุฏ ฺฉู ูุง ูุงูุนุงู ุจู ุญุงูุธู ุจุงูุฑ VGA (ุจู ุฌุง RAM ูุนููู) ุฏุณุชุฑุณ ูพุฏุง ู ฺฉูู ู ุฏุฑ ููุฑุฏ ุงุซุฑ ุฌุงูุจ ุขู ุนู ููุงุด ุจุฑุฎ ฺฉุงุฑุงฺฉุชุฑ ูุง ุฑู ุตูุญู ฺุฒ ูู ุฏุงูุฏ. ุจูุงุจุฑุงู ููฺฉู ุงุณุช ุชุตูู ุจฺฏุฑุฏ ฺฉู ุงู ููุดุชู ูุง ุบุฑุถุฑูุฑ ูุณุชูุฏ ู ู ุชูุงูุฏ ุขู ุฑุง ุญุฐู ฺฉูุฏ. ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงู ุจููู ุณุงุฒ ุงุดุชุจุงู ุ ุจุงุฏ ุงู ููุดุชู ูุง ุฑุง ุจู ุนููุงู <em><a href="https://en.wikipedia.org/wiki/Volatile_(computer_programming)">ูุฑูุงุฑ</a></em> ูุดุฎุต ฺฉูู. ุงู ุจู ฺฉุงููพุงูุฑ ู ฺฏูุฏ ฺฉู ููุดุชู ุนูุงุฑุถ ุฌุงูุจ ุฏุงุฑุฏ ู ูุจุงุฏ ุจููู ุดูุฏ.</p>
<p>ุจู ููุธูุฑ ุงุณุชูุงุฏู ุงุฒ ููุดุชู ูุง ูุฑุงุฑ ุจุฑุง ุจุงูุฑ VGA ุ ูุง ุงุฒ ฺฉุชุงุจุฎุงูู <a href="https://docs.rs/volatile">volatile</a> ุงุณุชูุงุฏู ู ฺฉูู. ุงู <em>crate</em> (ุจุณุชู ูุง ุฏุฑ ุฌูุงู Rust ุงูุทูุฑ ูุงูุฏู ูโุดููุฏ) ููุน <code>Volatile</code> ุฑุง ฺฉู ฺฉ ููุน wrapper ูุณุช ุจุง ูุชุฏ ูุง  <code>read</code> ู <code>write</code> ูุฑุงูู ู ฺฉูุฏ. ุงู ูุชุฏ ูุง ุจู ุทูุฑ ุฏุงุฎู ุงุฒ ุชูุงุจุน <a href="https://doc.rust-lang.org/nightly/core/ptr/fn.read_volatile.html">read_volatile</a> ู <a href="https://doc.rust-lang.org/nightly/core/ptr/fn.write_volatile.html">write_volatile</a> ฺฉุชุงุจุฎุงูู ุงุตู ุงุณุชูุงุฏู ู ฺฉููุฏ ู ุจูุงุจุฑุงู ุชุถูู ู ฺฉููุฏ ฺฉู ุฎูุงูุฏู/ ููุดุชู ุจุง ุจููู ุดุฏู ุญุฐู ููโุดููุฏ.</p>
<p>ูุง ู ุชูุงูู ูุงุจุณุชฺฏ ุจู ฺฉุฑุช (crate) <code>volatile</code> ุฑุง ุจูุณูู ุงุถุงูู ฺฉุฑุฏู ุขู ุจู ุจุฎุด <code>dependencies</code> (ูุงุจุณุชฺฏ ูุง) <code>Cargo.toml</code> ุงุถุงูู ฺฉูู:</p>
<pre data-lang="toml" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-toml "><code class="language-toml" data-lang="toml"><span style="color:#608b4e;"># in Cargo.toml
</span><span>
</span><span>[</span><span style="color:#808080;">dependencies</span><span>]
</span><span style="color:#569cd6;">volatile </span><span>= </span><span style="color:#d69d85;">&quot;0.2.6&quot;
</span></code></pre>
<p><code>0.2.6</code> ุดูุงุฑู ูุณุฎู <a href="https://semver.org/">ูุนูุง</a> ุงุณุช. ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑ ุ ุจู ุฑุงูููุง <a href="https://doc.crates.io/specifying-dependencies.html">ุชุนู ูุงุจุณุชฺฏ ูุง</a> ูุณุชูุฏุงุช ฺฉุงุฑฺฏู (cargo) ูุฑุงุฌุนู ฺฉูุฏ.</p>
<p>ุจุงุฏ ุงุฒ ุขู ุจุฑุง ููุดุชู ูุฑุงุฑ ุฏุฑ ุจุงูุฑ VGA ุงุณุชูุงุฏู ฺฉูู. ููุน <code>Buffer</code> ุฎูุฏ ุฑุง ุจู ุตูุฑุช ุฒุฑ ุจุฑูุฒุฑุณุงู ู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span style="color:#569cd6;">use </span><span>volatile::Volatile;
</span><span>
</span><span style="color:#569cd6;">struct </span><span>Buffer {
</span><span>    chars: [[Volatile&lt;ScreenChar&gt;; BUFFER_WIDTH]; BUFFER_HEIGHT],
</span><span>}
</span></code></pre>
<p>ุจู ุฌุง <code>ScreenChar</code> ุ ูุง ุงฺฉููู ุงุฒ <code>Volatile&lt;ScreenChar&gt;</code> ุงุณุชูุงุฏู ู ฺฉูู. (ููุน <code>Volatile</code>ุ <a href="https://doc.rust-lang.org/book/ch10-01-syntax.html">generic</a> ุงุณุช ู ู ุชูุงูุฏ (ุชูุฑุจุงู) ูุฑ ููุน ุฑุง ุฏุฑ ุฎูุฏ ูุฑุงุฑ ุฏูุฏ). ุงู ุงุทููุงู ู ุฏูุฏ ฺฉู ูุง ุจู ุทูุฑ ุชุตุงุฏู ูู ุชูุงูู ุงุฒ ุทุฑู ููุดุชู โุนุงุฏโ ุฏุฑ ุขู ุจููุณู. ุฏุฑ ุนูุถ ุ ุงฺฉููู ุจุงุฏ ุงุฒ ูุชุฏ <code>write</code> ุงุณุชูุงุฏู ฺฉูู.</p>
<p>ุงู ุจุฏุงู ูุนู ุงุณุช ฺฉู ูุง ุจุงุฏ ูุชุฏ <code>Writer::write_byte</code> ุฎูุฏ ุฑุง ุจู ุฑูุฒ ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span style="color:#569cd6;">impl </span><span>Writer {
</span><span>    </span><span style="color:#569cd6;">pub fn </span><span>write_byte(</span><span style="color:#569cd6;">&amp;mut </span><span>self, byte: </span><span style="color:#569cd6;">u8</span><span>) {
</span><span>        </span><span style="color:#569cd6;">match</span><span> byte {
</span><span>            </span><span style="color:#569cd6;">b</span><span style="color:#d69d85;">&#39;</span><span style="color:#e3bbab;">\n</span><span style="color:#d69d85;">&#39; </span><span style="color:#569cd6;">=&gt; </span><span>self.new_line(),
</span><span>            byte </span><span style="color:#569cd6;">=&gt; </span><span>{
</span><span>                </span><span style="color:#569cd6;">...
</span><span>
</span><span>                self.buffer.chars[row][col].write(ScreenChar {
</span><span>                    ascii_character: byte,
</span><span>                    color_code,
</span><span>                });
</span><span>                </span><span style="color:#569cd6;">...
</span><span>            }
</span><span>        }
</span><span>    }
</span><span>    </span><span style="color:#569cd6;">...
</span><span>}
</span></code></pre>
<p>ุจู ุฌุง ุงูุชุณุงุจ ุนุงุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ <code>=</code> ุ ุงฺฉููู ูุง ุงุฒ ูุชุฏ <code>write</code> ุงุณุชูุงุฏู ู ฺฉูู. ุงู ุชุถูู ู ฺฉูุฏ ฺฉู ฺฉุงููพุงูุฑ ูุฑฺฏุฒ ุงู ููุดุชู ุฑุง ุจููู ูุฎูุงูุฏ ฺฉุฑุฏ.</p>
<h3 id="mkhrwhy-qlbbndy"><a class="zola-anchor" href="index.html#mkhrwhy-qlbbndy" aria-label="Anchor link for: mkhrwhy-qlbbndy">๐</a>ูุงฺฉุฑูโูุง ูุงูุจโุจูุฏ</h3>
<p>ุฎูุจ ุงุณุช ฺฉู ุงุฒ ูุงฺฉุฑููุง ูุงูุจ ุจูุฏ Rust ูุฒ ูพุดุชุจุงู ฺฉูุฏ. ุจู ุงู ุชุฑุชุจ ุ ู ุชูุงูู ุงููุงุน ูุฎุชูู ูุงููุฏ ุนุฏุฏ ุตุญุญ ุง ุดูุงูุฑ ุฑุง ุจู ุฑุงุญุช ฺุงูพ ฺฉูู. ุจุฑุง ูพุดุชุจุงู ุงุฒ ุขููุง ุ ุจุงุฏ ุชุฑุช <a href="https://doc.rust-lang.org/nightly/core/fmt/trait.Write.html"><code>core::fmt::Write</code></a> ุฑุง ูพุงุฏู ุณุงุฒ ฺฉูู. ุชููุง ูุชุฏ ููุฑุฏ ูุงุฒ ุงู ุชุฑุช ุ<code>write_str</code> ุงุณุช ฺฉู ฺฉุงููุงู ุดุจู ุจู ูุชุฏ <code>write_str</code> ูุง ุงุณุช ุ ููุท ุจุง ููุน ุจุงุฒฺฏุดุช <code>fmt::Result</code>:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span style="color:#569cd6;">use </span><span>core::fmt;
</span><span>
</span><span style="color:#569cd6;">impl </span><span>fmt::Write </span><span style="color:#569cd6;">for </span><span>Writer {
</span><span>    </span><span style="color:#569cd6;">fn </span><span>write_str(</span><span style="color:#569cd6;">&amp;mut </span><span>self, s: </span><span style="color:#569cd6;">&amp;str</span><span>) -&gt; fmt::Result {
</span><span>        self.write_string(s);
</span><span>        Ok(())
</span><span>    }
</span><span>}
</span></code></pre>
<p><code>Ok(())</code> ููุท ูุชุฌู <code>Ok</code> ุญุงู ููุน <code>()</code> ุงุณุช.</p>
<p>ุงฺฉููู ูุง ู ุชูุงูู ุงุฒ ูุงฺฉุฑููุง ูุงูุจ ุจูุฏ ุฏุงุฎู ุฑุงุณุช ุนู <code>write!</code>/<code>writeln!</code> ุงุณุชูุงุฏู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span style="color:#569cd6;">pub fn </span><span>print_something() {
</span><span>    </span><span style="color:#569cd6;">use </span><span>core::fmt::Write;
</span><span>    </span><span style="color:#569cd6;">let mut</span><span> writer = Writer {
</span><span>        column_position: </span><span style="color:#b5cea8;">0</span><span>,
</span><span>        color_code: ColorCode::new(Color::Yellow, Color::Black),
</span><span>        buffer: </span><span style="color:#569cd6;">unsafe </span><span>{ </span><span style="color:#569cd6;">&amp;mut </span><span>*(</span><span style="color:#b5cea8;">0xb8000 </span><span style="color:#569cd6;">as *mut</span><span> Buffer) },
</span><span>    };
</span><span>
</span><span>    writer.write_byte(</span><span style="color:#569cd6;">b</span><span style="color:#d69d85;">&#39;H&#39;</span><span>);
</span><span>    writer.write_string(</span><span style="color:#d69d85;">&quot;ello! &quot;</span><span>);
</span><span>    write!(writer, </span><span style="color:#d69d85;">&quot;The numbers are </span><span style="color:#b4cea8;">{}</span><span style="color:#d69d85;"> and </span><span style="color:#b4cea8;">{}</span><span style="color:#d69d85;">&quot;</span><span>, </span><span style="color:#b5cea8;">42</span><span>, </span><span style="color:#b5cea8;">1.0</span><span>/</span><span style="color:#b5cea8;">3.0</span><span>).unwrap();
</span><span>}
</span></code></pre>
<p>ุญุงูุง ุดูุง ุจุงุฏ ฺฉ <code>Hello! The numbers are 42 and 0.3333333333333333</code> ุฏุฑ ูพุงู ุตูุญู ุจุจูุฏ. ูุฑุงุฎูุงู <code>write!</code> ฺฉ <code>Result</code> ุฑุง ุจุฑู ฺฏุฑุฏุงูุฏ ฺฉู ุฏุฑ ุตูุฑุช ุนุฏู ุงุณุชูุงุฏู ุจุงุนุซ ูุดุฏุงุฑ ู ุดูุฏ ุ ุจูุงุจุฑุงู ูุง ุชุงุจุน <a href="https://doc.rust-lang.org/core/result/enum.Result.html#method.unwrap"><code>unwrap</code></a> ุฑุง ุฑู ุขู ูุฑุงุฎูุงู ู ฺฉูู ฺฉู ุฏุฑ ุตูุฑุช ุจุฑูุฒ ุฎุทุง ูพูฺฉ ู ฺฉูุฏ. ุงู ุฏุฑ ููุฑุฏ ูุง ูุดฺฉู ูุฏุงุฑุฏ ุ ุฒุฑุง ููุดุชู ุฏุฑ ุจุงูุฑ VGA ูุฑฺฏุฒ ุดฺฉุณุช ููุฎูุฑุฏ.</p>
<h3 id="khtwt-jdyd"><a class="zola-anchor" href="index.html#khtwt-jdyd" aria-label="Anchor link for: khtwt-jdyd">๐</a>ุฎุทูุท ุฌุฏุฏ</h3>
<p>ุฏุฑ ุญุงู ุญุงุถุฑ ุ ูุง ุงุฒ ุฎุทูุท ุฌุฏุฏ ู ฺฉุงุฑุงฺฉุชุฑ ูุง ฺฉู ุฏฺฏุฑ ุฏุฑ ุฎุท ูู ฺฏูุฌูุฏ ฺุดู ูพูุด ู ฺฉูู. ุฏุฑุนูุถ ูุง ู ุฎูุงูู ูุฑ ฺฉุงุฑุงฺฉุชุฑ ุฑุง ฺฉ ุฎุท ุจู ุจุงูุง ููุชูู ฺฉูู (ุฎุท ุจุงูุง ุญุฐู ู ุดูุฏ) ู ุฏูุจุงุฑู ุงุฒ ุงุจุชุฏุง ุขุฎุฑู ุฎุท ุดุฑูุน ฺฉูู. ุจุฑุง ุงูุฌุงู ุงู ฺฉุงุฑ ุ ูุง ฺฉ ูพุงุฏู ุณุงุฒ ุจุฑุง ูุชุฏ <code>new_line</code> ุฏุฑ <code>Writer</code> ุงุถุงูู ู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span style="color:#569cd6;">impl </span><span>Writer {
</span><span>    </span><span style="color:#569cd6;">fn </span><span>new_line(</span><span style="color:#569cd6;">&amp;mut </span><span>self) {
</span><span>        </span><span style="color:#569cd6;">for</span><span> row </span><span style="color:#569cd6;">in </span><span style="color:#b5cea8;">1</span><span style="color:#569cd6;">..</span><span style="color:#b4cea8;">BUFFER_HEIGHT </span><span>{
</span><span>            </span><span style="color:#569cd6;">for</span><span> col </span><span style="color:#569cd6;">in </span><span style="color:#b5cea8;">0</span><span style="color:#569cd6;">..</span><span style="color:#b4cea8;">BUFFER_WIDTH </span><span>{
</span><span>                </span><span style="color:#569cd6;">let</span><span> character = self.buffer.chars[row][col].read();
</span><span>                self.buffer.chars[row - </span><span style="color:#b5cea8;">1</span><span>][col].write(character);
</span><span>            }
</span><span>        }
</span><span>        self.clear_row(</span><span style="color:#b4cea8;">BUFFER_HEIGHT </span><span>- </span><span style="color:#b5cea8;">1</span><span>);
</span><span>        self.column_position = </span><span style="color:#b5cea8;">0</span><span>;
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#569cd6;">fn </span><span>clear_row(</span><span style="color:#569cd6;">&amp;mut </span><span>self, row: </span><span style="color:#569cd6;">usize</span><span>) {</span><span style="color:#608b4e;">/* TODO */</span><span>}
</span><span>}
</span></code></pre>
<p>ูุง ุชูุงู ฺฉุงุฑุงฺฉุชุฑูุง ุตูุญู ุฑุง ูพูุงุด ู ฺฉูู ู ูุฑ ฺฉุงุฑุงฺฉุชุฑ ุฑุง ฺฉ ุฑุฏู ุจู ุจุงูุง ุดูุช ู ุฏูู. ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุนูุงูุช ฺฏุฐุงุฑ ุฏุงููู (<code>..</code>)  ูุงูุฏ ููุฏุงุฑ ุญุฏ ุจุงูุง ุงุณุช. ูุง ููฺูู ุณุทุฑ 0 ุฑุง ุญุฐู ู ฺฉูู (ุงูู ูุญุฏูุฏู ุงุฒ โ1โ ุดุฑูุน ู ุดูุฏ) ุฒุฑุง ุงู ุณุทุฑ ุงุณุช ฺฉู ุงุฒ ุตูุญู ุจู ุจุฑูู ุดูุช ู ุดูุฏ.</p>
<p>ุจุฑุง ุชฺฉูู ฺฉุฏ <code>newline</code> ุ ูุชุฏ <code>clear_row</code> ุฑุง ุงุถุงูู ู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span style="color:#569cd6;">impl </span><span>Writer {
</span><span>    </span><span style="color:#569cd6;">fn </span><span>clear_row(</span><span style="color:#569cd6;">&amp;mut </span><span>self, row: </span><span style="color:#569cd6;">usize</span><span>) {
</span><span>        </span><span style="color:#569cd6;">let</span><span> blank = ScreenChar {
</span><span>            ascii_character: </span><span style="color:#569cd6;">b</span><span style="color:#d69d85;">&#39; &#39;</span><span>,
</span><span>            color_code: self.color_code,
</span><span>        };
</span><span>        </span><span style="color:#569cd6;">for</span><span> col </span><span style="color:#569cd6;">in </span><span style="color:#b5cea8;">0</span><span style="color:#569cd6;">..</span><span style="color:#b4cea8;">BUFFER_WIDTH </span><span>{
</span><span>            self.buffer.chars[row][col].write(blank);
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre>
<p>ุงู ูุชุฏ ุจุง ุฌุงฺฏุฒู ุชูุงู ฺฉุงุฑุงฺฉุชุฑูุง ุจุง ฺฉ ฺฉุงุฑุงฺฉุชุฑ ูุงุตูู ุ ฺฉ ุณุทุฑ ุฑุง ูพุงฺฉ ู ฺฉูุฏ.</p>
<h2 id="ykh-rbt-glwbl"><a class="zola-anchor" href="index.html#ykh-rbt-glwbl" aria-label="Anchor link for: ykh-rbt-glwbl">๐</a>ฺฉ ุฑุงุจุท ฺฏููุจุงู</h2>
<p>ุจุฑุง ูุฑุงูู ฺฉุฑุฏู ฺฉ ููุณูุฏู ฺฏููุจุงู ฺฉู ุจุชูุงูุฏ ุจู ุนููุงู ุฑุงุจุท ุงุฒ ุณุงุฑ ูุงฺูู ูุง ุจุฏูู ุญูู ููููู <code>Writer</code> ุฏุฑ ุงุทุฑุงู ุงุณุชูุงุฏู ุดูุฏ ุ ุณุน ู ฺฉูู ฺฉ <code>WRITER</code> ุซุงุจุช ุงุฌุงุฏ ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span style="color:#569cd6;">pub static </span><span style="color:#b4cea8;">WRITER</span><span>: Writer = Writer {
</span><span>    column_position: </span><span style="color:#b5cea8;">0</span><span>,
</span><span>    color_code: ColorCode::new(Color::Yellow, Color::Black),
</span><span>    buffer: </span><span style="color:#569cd6;">unsafe </span><span>{ </span><span style="color:#569cd6;">&amp;mut </span><span>*(</span><span style="color:#b5cea8;">0xb8000 </span><span style="color:#569cd6;">as *mut</span><span> Buffer) },
</span><span>};
</span></code></pre>
<p>ุจุง ุงู ุญุงู ุ ุงฺฏุฑ ุณุน ฺฉูู ุงฺฉููู ุขู ุฑุง ฺฉุงููพุงู ฺฉูู ุ ุฎุทุงูุง ุฒุฑ ุฑุฎ ู ุฏูุฏ:</p>
<pre style="background-color:#1e1e1e;color:#dcdcdc;"><code><span>error[E0015]: calls in statics are limited to constant functions, tuple structs and tuple variants
</span><span> --&gt; src/vga_buffer.rs:7:17
</span><span>  |
</span><span>7 |     color_code: ColorCode::new(Color::Yellow, Color::Black),
</span><span>  |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
</span><span>
</span><span>error[E0396]: raw pointers cannot be dereferenced in statics
</span><span> --&gt; src/vga_buffer.rs:8:22
</span><span>  |
</span><span>8 |     buffer: unsafe { &amp;mut *(0xb8000 as *mut Buffer) },
</span><span>  |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ dereference of raw pointer in constant
</span><span>
</span><span>error[E0017]: references in statics may only refer to immutable values
</span><span> --&gt; src/vga_buffer.rs:8:22
</span><span>  |
</span><span>8 |     buffer: unsafe { &amp;mut *(0xb8000 as *mut Buffer) },
</span><span>  |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ statics require immutable values
</span><span>
</span><span>error[E0017]: references in statics may only refer to immutable values
</span><span> --&gt; src/vga_buffer.rs:8:13
</span><span>  |
</span><span>8 |     buffer: unsafe { &amp;mut *(0xb8000 as *mut Buffer) },
</span><span>  |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ statics require immutable values
</span></code></pre>
<p>ุจุฑุง ูููุฏู ุขูฺู ุฏุฑ ุงูุฌุง ุงุชูุงู ู ุงูุชุฏ ุ ุจุงุฏ ุจุฏุงูู ฺฉู ุซุงุจุช ูุง(Statics) ุฏุฑ ุฒูุงู ฺฉุงููพุงู ููุฏุงุฑุฏู ุงููู ู ุดููุฏ ุ ุจุฑุฎูุงู ูุชุบุฑูุง ุนุงุฏ ฺฉู ุฏุฑ ุฒูุงู ุงุฌุฑุง ููุฏุงุฑุฏู ุงููู ู ุดููุฏ. ูููููโุง(component) ุงุฒ ฺฉุงููพุงูุฑ Rust ฺฉู ฺูู ุนุจุงุฑุงุช ููุฏุงุฑุฏู ุงููู ุฑุง ุงุฑุฒุงุจ ู ฺฉูุฏ ุ โ<a href="https://rustc-dev-guide.rust-lang.org/const-eval.html">const evaluator</a>โ ูุงูุฏู ู ุดูุฏ. ุนููฺฉุฑุฏ ุขู ูููุฒ ูุญุฏูุฏ ุงุณุช ุ ุงูุง ฺฉุงุฑูุง ฺฏุณุชุฑุฏู ุง ุจุฑุง ฺฏุณุชุฑุด ุขู ุฏุฑ ุญุงู ุงูุฌุงู ุงุณุช ุ ุจู ุนููุงู ูุซุงู ุฏุฑ โ<a href="https://github.com/rust-lang/rfcs/pull/2345">Allow panicking in constants</a>โ RFC.</p>
<p>ูุณุฆูู ุฏุฑ ููุฑุฏ <code>ColorCode::new</code> ุจุง ุงุณุชูุงุฏู ุงุฒ ุชูุงุจุน <a href="https://doc.rust-lang.org/reference/const_eval.html#const-functions"><code>const</code> functions</a> ูุงุจู ุญู ุงุณุช ุ ุงูุง ูุดฺฉู ุงุณุงุณ ุงูุฌุงุณุช ฺฉู Rustโs const evaluator ูุงุฏุฑ ุจู ุชุจุฏู ุงุดุงุฑูโฺฏุฑโูุง ุฎุงู ุจู ุฑูุฑูุณ ุฏุฑ ุฒูุงู ฺฉุงููพุงู ูุณุช. ุดุงุฏ ุฑูุฒ ุฌูุงุจ ุฏูุฏ ุ ุงูุง ุชุง ุขู ุฒูุงู ุ ูุง ุจุงุฏ ุฑุงู ุญู ุฏฺฏุฑ ูพุฏุง ฺฉูู.</p>
<h3 id="sttykhhy-tnbl-lazy-statics"><a class="zola-anchor" href="index.html#sttykhhy-tnbl-lazy-statics" aria-label="Anchor link for: sttykhhy-tnbl-lazy-statics">๐</a>ุงุณุชุงุชฺฉโูุง ุชูุจู (Lazy Statics)</h3>
<p>ฺฉุจุงุฑ ููุฏุงุฑุฏู ุงููู ุงุณุชุงุชฺฉโูุง ุจุง ุชูุงุจุน ุบุฑ ุซุงุจุช ฺฉ ูุดฺฉู ุฑุงุฌ ุฏุฑ ุฑุงุณุช ุงุณุช. ุฎูุดุจุฎุชุงูู ุ ุฏุฑ ุญุงู ุญุงุถุฑ ุฑุงู ุญู ุฎูุจ ุฏุฑ ฺฉุฑุช ุจู ูุงู <a href="https://docs.rs/lazy_static/1.0.1/lazy_static/">lazy_static</a> ูุฌูุฏ ุฏุงุฑุฏ. ุงู ฺฉุฑุช ูุงฺฉุฑู <code>lazy_static!</code> ุฑุง ูุฑุงูู ู ฺฉูุฏ ฺฉู ฺฉ <code>ุงุณุชุงุชฺฉ</code> ุฑุง ุจุง ุชูุจู ููุฏุงุฑโุฏู ุงููู ู ฺฉูุฏ. ุจู ุฌุง ูุญุงุณุจู ููุฏุงุฑ ุขู ุฏุฑ ุฒูุงู ฺฉุงููพุงู ุ <code>ุงุณุชุงุชฺฉ</code> ุจู ุชูุจู ููฺฏุงู ุงููู ุฏุณุชุฑุณ ุจู ุขูุ ุฎูุฏ ุฑุง ููุฏุงุฑุฏู ุงููู ูโฺฉูุฏ. ุจูุงุจุฑุงู ุ ููุฏุงุฑุฏู ุงููู ุฏุฑ ุฒูุงู ุงุฌุฑุง ุงุชูุงู ู ุงูุชุฏ ุชุง ฺฉุฏ ููุฏุงุฑ ุฏู ุงููู  ูพฺุฏู ู ุฏูุฎูุงู ุงูฺฉุงู ูพุฐุฑ ุจุงุดุฏ.</p>
<p>ุจุงุฏ ฺฉุฑุช <code>lazy_static</code> ุฑุง ุจู ูพุฑูฺู ุฎูุฏ ุงุถุงูู ฺฉูู:</p>
<pre data-lang="toml" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-toml "><code class="language-toml" data-lang="toml"><span style="color:#608b4e;"># in Cargo.toml
</span><span>
</span><span>[</span><span style="color:#808080;">dependencies.lazy_static</span><span>]
</span><span style="color:#569cd6;">version </span><span>= </span><span style="color:#d69d85;">&quot;1.0&quot;
</span><span style="color:#569cd6;">features </span><span>= [</span><span style="color:#d69d85;">&quot;spin_no_std&quot;</span><span>]
</span></code></pre>
<p>ูุง ุจู ูฺฺฏ <code>spin_no_std</code> ูุงุฒ ุฏุงุฑู ุ ุฒุฑุง ุจู ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ูพููุฏ ูู ุฏูู.</p>
<p>ุจุง ุงุณุชูุงุฏู ุงุฒ <code>lazy_static</code> ุ ู ุชูุงูู WRITER ุซุงุจุช ุฎูุฏ ุฑุง ุจุฏูู ูุดฺฉู ุชุนุฑู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span style="color:#569cd6;">use </span><span>lazy_static::lazy_static;
</span><span>
</span><span>lazy_static! {
</span><span>    </span><span style="color:#569cd6;">pub static ref </span><span style="color:#b4cea8;">WRITER</span><span>: Writer = Writer {
</span><span>        column_position: </span><span style="color:#b5cea8;">0</span><span>,
</span><span>        color_code: ColorCode::new(Color::Yellow, Color::Black),
</span><span>        buffer: </span><span style="color:#569cd6;">unsafe </span><span>{ </span><span style="color:#569cd6;">&amp;mut </span><span>*(</span><span style="color:#b5cea8;">0xb8000 </span><span style="color:#569cd6;">as *mut</span><span> Buffer) },
</span><span>    };
</span><span>}
</span></code></pre>
<p>ุจุง ุงู ุญุงู ุ ุงู <code>WRITER</code> ุจุณุงุฑ ุจ ูุงุฏู ุงุณุช ุฒุฑุง ุบุฑ ูุงุจู ุชุบุฑ ุงุณุช. ุงู ุจุฏุงู ูุนู ุงุณุช ฺฉู ูุง ูู ุชูุงูู ฺุฒ ุฏุฑ ุขู ุจููุณู (ุงุฒ ุขูุฌุง ฺฉู ููู ูุชุฏ ูุง ููุดุชู <code>&amp;mut self</code> ุฑุง ุฏุฑ ูุฑูุฏ ูฺฏุฑูุฏ). ฺฉ ุฑุงู ุญู ููฺฉู ุงุณุชูุงุฏู ุงุฒ <a href="https://doc.rust-lang.org/book/ch19-01-unsafe-rust.html#accessing-or-modifying-a-mutable-static-variable">ุงุณุชุงุชฺฉ ูุงุจู ุชุบุฑ</a> ุงุณุช. ุงูุง ูพุณ ุงุฒ ุขู ูุฑ ุฎูุงูุฏู ู ููุดุชู ุขู ูุงุงูู (unsafe) ุงุณุช ุฒุฑุง ู ุชูุงูุฏ ุจู ุฑุงุญุช ุจุงุนุซ data race ู ุณุงุฑ ููุงุฑุฏ ุจุฏ ุจุงุดุฏ. ุงุณุชูุงุฏู ุงุฒ <code>static mut</code> ุจุณุงุฑ ูู ุดุฏู ุงุณุช ุ ุญุช ูพุดููุงุฏูุง ุจุฑุง <a href="https://internals.rust-lang.org/t/pre-rfc-remove-static-mut/1437">ุญุฐู ุขู</a> ูุฌูุฏ ุฏุงุดุช. ุงูุง ฺฏุฒูู ูุง ุฏฺฏุฑ ฺุณุชุ ูุง ู ุชูุงูู ุณุน ฺฉูู ุงุฒ ฺฉ ุงุณุชุงุชฺฉ ุชุบุฑูุงูพุฐุฑ ุจุง ููุน ุณููู ูุงููุฏ <a href="https://doc.rust-lang.org/book/ch15-05-interior-mutability.html#keeping-track-of-borrows-at-runtime-with-refcellt">RefCell</a> ุง ุญุช <a href="https://doc.rust-lang.org/nightly/core/cell/struct.UnsafeCell.html">UnsafeCell</a> ุงุณุชูุงุฏู ฺฉูู ฺฉู <a href="https://doc.rust-lang.org/book/ch15-05-interior-mutability.html">ุชุบุฑ ูพุฐุฑ ุฏุงุฎู</a> ุฑุง ูุฑุงูู ู ฺฉูุฏ. ุงูุง ุงู ุงููุงุน <a href="https://doc.rust-lang.org/nightly/core/marker/trait.Sync.html">Sync</a> ูุณุชูุฏ (ุจุง ุฏูู ฺฉุงู) ุ ุจูุงุจุฑุงู ูู ุชูุงูู ุงุฒ ุขููุง ุฏุฑ ุงุณุชุงุชฺฉ ุงุณุชูุงุฏู ฺฉูู.</p>
<h3 id="spinlocks"><a class="zola-anchor" href="index.html#spinlocks" aria-label="Anchor link for: spinlocks">๐</a>Spinlocks</h3>
<p>ุจุฑุง ุฏุณุชุงุจ ุจู ูุงุจูุช ุชุบุฑูพุฐุฑ ุฏุงุฎู ููุฒูุงู (synchronized) ุ ฺฉุงุฑุจุฑุงู ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ู ุชูุงููุฏ ุงุฒ <a href="https://doc.rust-lang.org/nightly/std/sync/struct.Mutex.html">Mutex</a> ุงุณุชูุงุฏู ฺฉููุฏ. ููฺฏุงู ฺฉู ููุจุน ุงุฒ ูุจู ููู ุดุฏู ุงุณุช ุ ุจุง ูุณุฏูุฏ ฺฉุฑุฏู ุฑุดุชู ูุง ุ ุงูฺฉุงู ุงูุญุตุงุฑ ูุชูุงุจู ุฑุง ูุฑุงูู ู ฺฉูุฏ. ุงูุง ูุณุชู ุงุตู ูุง ูฺ ูพุดุชุจุงู ุงุฒ ูุณุฏูุฏ ฺฉุฑุฏู ุง ุญุช ููููู ุงุฒ ูุฎ ูุง ูุฏุงุฑุฏ ุ ุจูุงุจุฑุงู ูุง ูู ูู ุชูุงูู ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูู. ุจุง ุงู ูุฌูุฏ ฺฉ ููุน ฺฉุงููุงู ูพุงูโุง ุงุฒ mutex ุฏุฑ ุนููู ฺฉุงููพูุชุฑ ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ุจู ูฺ ูฺฺฏ ุณุณุชู ุนุงูู ูุงุฒ ูุฏุงุฑุฏ: <a href="https://en.wikipedia.org/wiki/Spinlock">spinlock</a>. ุจู ุฌุง ูุณุฏูุฏ ฺฉุฑุฏู ุ ูุฎ ูุง ุณุน ู ฺฉููุฏ ุขู ุฑุง ุจุงุฑูุง ู ุจุงุฑูุง ุฏุฑ ฺฉ ุญููู ููู ฺฉููุฏ ู ุจูุงุจุฑุงู ุฒูุงู ูพุฑุฏุงุฒูุฏู ุฑุง ู ุณูุฒุงููุฏ ุชุง ุฏูุจุงุฑู mutex ุขุฒุงุฏ ุดูุฏ.</p>
<p>ุจุฑุง ุงุณุชูุงุฏู ุงุฒ spinning mutex ุ ู ุชูุงูู <a href="https://crates.io/crates/spin">ฺฉุฑุช spin</a> ุฑุง ุจู ุนููุงู ฺฉ ูุงุจุณุชฺฏ ุงุถุงูู ฺฉูู:</p>
<pre data-lang="toml" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-toml "><code class="language-toml" data-lang="toml"><span style="color:#608b4e;"># in Cargo.toml
</span><span>[</span><span style="color:#808080;">dependencies</span><span>]
</span><span style="color:#569cd6;">spin </span><span>= </span><span style="color:#d69d85;">&quot;0.5.2&quot;
</span></code></pre>
<p>ุณูพุณ ู ุชูุงูู ุงุฒ spinning Mutex ุจุฑุง ุงูุฒูุฏู <a href="https://doc.rust-lang.org/book/ch15-05-interior-mutability.html">ุชุบุฑ ูพุฐุฑ ุฏุงุฎู</a> ุงูู ุจู <code>WRITER</code> ุงุณุชุงุชฺฉ ุฎูุฏ ุงุณุชูุงุฏู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span style="color:#569cd6;">use </span><span>spin::Mutex;
</span><span style="color:#569cd6;">...
</span><span>lazy_static! {
</span><span>    </span><span style="color:#569cd6;">pub static ref </span><span style="color:#b4cea8;">WRITER</span><span>: Mutex&lt;Writer&gt; = Mutex::new(Writer {
</span><span>        column_position: </span><span style="color:#b5cea8;">0</span><span>,
</span><span>        color_code: ColorCode::new(Color::Yellow, Color::Black),
</span><span>        buffer: </span><span style="color:#569cd6;">unsafe </span><span>{ </span><span style="color:#569cd6;">&amp;mut </span><span>*(</span><span style="color:#b5cea8;">0xb8000 </span><span style="color:#569cd6;">as *mut</span><span> Buffer) },
</span><span>    });
</span><span>}
</span></code></pre>
<p>ุงฺฉููู ู ุชูุงูู ุชุงุจุน <code>print_something</code> ุฑุง ุญุฐู ฺฉุฑุฏู ู ูุณุชููุงู ุงุฒ ุชุงุจุน<code>_start</code> ุฎูุฏ ฺุงูพ ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/main.rs
</span><span>#[no_mangle]
</span><span style="color:#569cd6;">pub extern </span><span style="color:#d69d85;">&quot;C&quot; </span><span style="color:#569cd6;">fn </span><span>_start() -&gt; </span><span style="color:#569cd6;">! </span><span>{
</span><span>    </span><span style="color:#569cd6;">use </span><span>core::fmt::Write;
</span><span>    vga_buffer::</span><span style="color:#b4cea8;">WRITER</span><span>.lock().write_str(</span><span style="color:#d69d85;">&quot;Hello again&quot;</span><span>).unwrap();
</span><span>    write!(vga_buffer::WRITER.lock(), </span><span style="color:#d69d85;">&quot;, some numbers: </span><span style="color:#b4cea8;">{} {}</span><span style="color:#d69d85;">&quot;</span><span>, </span><span style="color:#b5cea8;">42</span><span>, </span><span style="color:#b5cea8;">1.337</span><span>).unwrap();
</span><span>
</span><span>    </span><span style="color:#569cd6;">loop </span><span>{}
</span><span>}
</span></code></pre>
<p>ุจุฑุง ุงูฺฉู ุจุชูุงูู ุงุฒ ุชูุงุจุน ุขู ุงุณุชูุงุฏู ฺฉูู ุ ุจุงุฏ ุชุฑุช <code>fmt::Write</code> ุฑุง ูุงุฑุฏ ฺฉูู.</p>
<h3 id="ymny"><a class="zola-anchor" href="index.html#ymny" aria-label="Anchor link for: ymny">๐</a>ุงูู</h3>
<p>ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ูุง ููุท ฺฉ ุจููฺฉ ูุงุงูู ุฏุฑ ฺฉุฏ ุฎูุฏ ุฏุงุฑู ฺฉู ุจุฑุง ุงุฌุงุฏ ุฑูุฑูุณ <code>Buffer</code> ุจุง ุงุดุงุฑู ุจู <code>0xb8000</code> ูุงุฒู ุงุณุช. ูพุณ ุงุฒ ุขู ุ ุชูุงู ุนููุงุช ุงูู ูุณุชูุฏ. Rust ุจู ุทูุฑ ูพุด ูุฑุถ ุงุฒ ุจุฑุฑุณ ูุฑุฒูุง ุฏุฑ ุฏุณุชุฑุณ ุจู ุขุฑุงู ุงุณุชูุงุฏู ู ฺฉูุฏ ุ ุจูุงุจุฑุงู ูู ุชูุงูู ุจู ุทูุฑ ุงุชูุงู ุฎุงุฑุฌ ุงุฒ ุจุงูุฑ ุจููุณู. ุจูุงุจุฑุงู ุ ูุง ุดุฑุงุท ููุฑุฏ ูุงุฒ ุฑุง ุฏุฑ ุณุณุชู ููุน ุงูุฌุงู ูโุฏูู ู ูุงุฏุฑ ุจู ุงุฌุงุฏ ฺฉ ุฑุงุจุท ุงูู ุจู ุฎุงุฑุฌ ูุณุชู.</p>
<h3 id="ykh-mkhrwy-println"><a class="zola-anchor" href="index.html#ykh-mkhrwy-println" aria-label="Anchor link for: ykh-mkhrwy-println">๐</a>ฺฉ ูุงฺฉุฑู println</h3>
<p>ุงฺฉููู ฺฉู ฺฉ ููุณูุฏู ฺฏููุจุงู ุฏุงุฑู ุ ู ุชูุงูู ฺฉ ูุงฺฉุฑู <code>println</code> ุงุถุงูู ฺฉูู ฺฉู ู ุชูุงูุฏ ุงุฒ ูุฑ ฺฉุฌุง ุฏุฑ ฺฉุฏ ุงุณุชูุงุฏู ุดูุฏ. <a href="https://doc.rust-lang.org/nightly/book/ch19-06-macros.html#declarative-macros-with-macro_rules-for-general-metaprogramming">ุณูุชฺฉุณ ูุงฺฉุฑู</a> ุฑุงุณุช ฺฉู ุนุฌุจ ุงุณุช ุ ุจูุงุจุฑุงู ูุง ุณุน ูู ฺฉูู ูุงฺฉุฑู ุฑุง ุงุฒ ุงุจุชุฏุง ุจููุณู. ุฏุฑ ุนูุถ ุจู ุณูุฑุณ <a href="https://doc.rust-lang.org/nightly/std/macro.println!.html">ูุงฺฉุฑู <code>println!</code></a> ุฏุฑ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ูฺฏุงู ู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span>#[macro_export]
</span><span>macro_rules! println {
</span><span>    () </span><span style="color:#569cd6;">=&gt; </span><span>(print!(</span><span style="color:#d69d85;">&quot;</span><span style="color:#e3bbab;">\n</span><span style="color:#d69d85;">&quot;</span><span>));
</span><span>    (</span><span style="color:#569cd6;">$</span><span>($arg:</span><span style="color:#569cd6;">tt</span><span>)</span><span style="color:#569cd6;">*</span><span>) </span><span style="color:#569cd6;">=&gt; </span><span>(print!(</span><span style="color:#d69d85;">&quot;</span><span style="color:#b4cea8;">{}</span><span style="color:#e3bbab;">\n</span><span style="color:#d69d85;">&quot;</span><span>, format_args!(</span><span style="color:#569cd6;">$</span><span>($arg)*)));
</span><span>}
</span></code></pre>
<p>ูุงฺฉุฑููุง ุงุฒ ุทุฑู ฺฉ ุง ฺูุฏ ูุงููู ุชุนุฑู ู ุดููุฏ ฺฉู ุดุจู ุจุงุฒููุง <code>match</code> ูุณุชูุฏ. ูุงฺฉุฑู <code>println</code> ุฏุงุฑุง ุฏู ูุงููู ุงุณุช: ุงููู ูุงููู ุจุฑุง ูุฑุงุฎูุงู ูุง ุจุฏูู ุขุฑฺฏูุงู ุงุณุช (ุจู ุนููุงู ูุซุงู: <code>println!()</code>) ุ ฺฉู ุจู <code>print!(&quot;\n&quot;)</code> ฺฏุณุชุฑุด ู ุงุจุฏุ ุจูุงุจุฑุงู ููุท ฺฉ ุฎุท ุฌุฏุฏ ุฑุง ฺุงูพ ู ฺฉูุฏ. ูุงููู ุฏูู ุจุฑุง ูุฑุงุฎูุงู ูุง ุจุง ูพุงุฑุงูุชุฑูุง ูุงููุฏ <code>println!(&quot;Hello&quot;)</code> ุง <code>println!(&quot;Number: {}&quot;, 4)</code> ุงุณุช. ููฺูู ุจุง ูุฑุงุฎูุงู ฺฉู ุขุฑฺฏููุงู ูุง ู ฺฉ ุฎุท ุฌุฏุฏ <code>\n</code> ุงุถุงู ุฏุฑ ุงูุชูุง ุ ุจู ูุฑุงุฎูุงู ูุงฺฉุฑู <code>print!</code> ฺฏุณุชุฑุด ู ุงุจุฏ.</p>
<p>ูฺฺฏ <code>#[macro_export]</code> ูุงฺฉุฑู ุฑุง ุจุฑุง ฺฉู ฺฉุฑุช (ูู ููุท ูุงฺูู ฺฉู ุชุนุฑู ุดุฏู ุงุณุช) ู ฺฉุฑุช ูุง ุฎุงุฑุฌ ุฏุฑ ุฏุณุชุฑุณ ูุฑุงุฑ ู ุฏูุฏ. ููฺูู ูุงฺฉุฑู ุฑุง ุฏุฑ ุฑุดู ฺฉุฑุช ูุฑุงุฑ ู ุฏูุฏ ุ ุจู ุงู ูุนู ฺฉู ูุง ุจุงุฏ ูุงฺฉุฑู ุฑุง ุจู ุฌุง <code>std::macros::println</code> ุงุฒ ุทุฑู <code>use std::println</code> ูุงุฑุฏ ฺฉูู.</p>
<p><a href="https://doc.rust-lang.org/nightly/std/macro.print!.html">ูุงฺฉุฑู <code>print!</code></a> ุจู ุงู ุตูุฑุช ุชุนุฑู ู ุดูุฏ:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span>#[macro_export]
</span><span>macro_rules! print {
</span><span>    (</span><span style="color:#569cd6;">$</span><span>($arg:</span><span style="color:#569cd6;">tt</span><span>)</span><span style="color:#569cd6;">*</span><span>) </span><span style="color:#569cd6;">=&gt; </span><span>($crate::io::_print(format_args!(</span><span style="color:#569cd6;">$</span><span>($arg)*)));
</span><span>}
</span></code></pre>
<p>ูุงฺฉุฑู ุจู ูุฑุงุฎูุงู <a href="https://github.com/rust-lang/rust/blob/29f5c699b11a6a148f097f82eaa05202f8799bbc/src/libstd/io/stdio.rs#L698">ุชุงุจุน <code>_print</code></a> ุฏุฑ ูุงฺูู <code>io</code> ฺฏุณุชุฑุด ู ุงุจุฏ. <a href="https://doc.rust-lang.org/1.30.0/book/first-edition/macros.html#the-variable-crate">ูุชุบุฑ <code>$crate</code></a> ุชุถูู ู ฺฉูุฏ ฺฉู ูุงฺฉุฑู ููฺฏุงู ฺฏุณุชุฑุด ุฏุฑ <code>std</code> ุฏุฑ ุฒูุงู ุงุณุชูุงุฏู ุฏุฑ ฺฉุฑุช ูุง ุฏฺฏุฑุ ุฏุฑ ุฎุงุฑุฌ ุงุฒ ฺฉุฑุช <code>std</code> ูุฒ ฺฉุงุฑ ู ฺฉูุฏ.</p>
<p><a href="https://doc.rust-lang.org/nightly/std/macro.format_args.html">ูุงฺฉุฑู <code>format_args</code></a> ุงุฒ ุขุฑฺฏูุงู ูุง ุฏุงุฏู ุดุฏู ฺฉ ููุน <a href="https://doc.rust-lang.org/nightly/core/fmt/struct.Arguments.html">fmt::Arguments</a> ุฑุง ู ุณุงุฒุฏ ฺฉู ุจู <code>_print</code> ุงุฑุณุงู ู ุดูุฏ. <a href="https://github.com/rust-lang/rust/blob/29f5c699b11a6a148f097f82eaa05202f8799bbc/src/libstd/io/stdio.rs#L698">ุชุงุจุน <code>_print</code></a> ุงุฒ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏุ<code>print_to</code> ุฑุง ูุฑุงุฎูุงู ู ฺฉูุฏ ุ ฺฉู ุจุณุงุฑ ูพฺุฏู ุงุณุช ุฒุฑุง ุงุฒ ุฏุณุชฺฏุงู ูุง ูุฎุชูู <code>Stdout</code> ูพุดุชุจุงู ู ฺฉูุฏ. ูุง ุจู ุงู ูพฺุฏฺฏ ุงุญุชุงุฌ ูุฏุงุฑู ุฒุฑุง ููุท ู ุฎูุงูู ุฏุฑ ุจุงูุฑ VGA ฺุงูพ ฺฉูู.</p>
<p>ุจุฑุง ฺุงูพ ุฏุฑ ุจุงูุฑ VGA ุ ูุง ููุท ูุงฺฉุฑููุง <code>println!</code> ู <code>print!</code> ุฑุง ฺฉูพ ู ฺฉูู ุ ุงูุง ุขููุง ุฑุง ุงุตูุงุญ ู ฺฉูู ุชุง ุงุฒ ุชุงุจุน <code>_print</code> ุฎูุฏ ุงุณุชูุงุฏู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/vga_buffer.rs
</span><span>
</span><span>#[macro_export]
</span><span>macro_rules! print {
</span><span>    (</span><span style="color:#569cd6;">$</span><span>($arg:</span><span style="color:#569cd6;">tt</span><span>)</span><span style="color:#569cd6;">*</span><span>) </span><span style="color:#569cd6;">=&gt; </span><span>($crate::vga_buffer::_print(format_args!(</span><span style="color:#569cd6;">$</span><span>($arg)*)));
</span><span>}
</span><span>
</span><span>#[macro_export]
</span><span>macro_rules! println {
</span><span>    () </span><span style="color:#569cd6;">=&gt; </span><span>($crate::print</span><span style="color:#569cd6;">!</span><span>(</span><span style="color:#d69d85;">&quot;</span><span style="color:#e3bbab;">\n</span><span style="color:#d69d85;">&quot;</span><span>));
</span><span>    (</span><span style="color:#569cd6;">$</span><span>($arg:</span><span style="color:#569cd6;">tt</span><span>)</span><span style="color:#569cd6;">*</span><span>) </span><span style="color:#569cd6;">=&gt; </span><span>($crate::print</span><span style="color:#569cd6;">!</span><span>(</span><span style="color:#d69d85;">&quot;{}</span><span style="color:#e3bbab;">\n</span><span style="color:#d69d85;">&quot;</span><span>, format_args!(</span><span style="color:#569cd6;">$</span><span>($arg)*)));
</span><span>}
</span><span>
</span><span>#[doc(hidden)]
</span><span style="color:#569cd6;">pub fn </span><span>_print(args: fmt::Arguments) {
</span><span>    </span><span style="color:#569cd6;">use </span><span>core::fmt::Write;
</span><span>    </span><span style="color:#b4cea8;">WRITER</span><span>.lock().write_fmt(args).unwrap();
</span><span>}
</span></code></pre>
<p>ฺุฒ ฺฉู ูุง ุงุฒ ุชุนุฑู ุงุตู <code>println</code> ุชุบุฑ ุฏุงุฏู ุงู ุงุณุช ฺฉู ูุฑุงุฎูุงู ูุงฺฉุฑู <code>print!</code> ุฑุง ุจุง ูพุดููุฏ <code>$crate</code> ุงูุฌุงู ู ุฏูู. ุงู ุชุถูู ู ฺฉูุฏ ฺฉู ุงฺฏุฑ ููุท ู ุฎูุงูู ุงุฒ <code>println</code> ุงุณุชูุงุฏู ฺฉูู ุ ูุงุฒ ุจู ูุงุฑุฏ ฺฉุฑุฏู ูุงฺฉุฑู <code>print!</code> ูู ูุฏุงุดุชู ุจุงุดู.</p>
<p>ูุงููุฏ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ุ ูฺฺฏ <code>#[macro_export]</code> ุฑุง ุจู ูุฑ ุฏู ูุงฺฉุฑู ุงุถุงูู ู ฺฉูู ุชุง ุฏุฑ ููู ุฌุง ฺฉุฑุช ูุง ุฏุฑ ุฏุณุชุฑุณ ุจุงุดูุฏ. ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุงู ูุงฺฉุฑููุง ุฑุง ุฏุฑ ูุถุง ูุงู ุฑุดู ฺฉุฑุช ูุฑุงุฑ ู ุฏูุฏ ุ ุจูุงุจุฑุงู ูุงุฑุฏ ฺฉุฑุฏู ุขููุง ุงุฒ ุทุฑู <code>use crate::vga_buffer::println</code> ฺฉุงุฑ ูู ฺฉูุฏ. ุฏุฑ ุนูุถ ุ ูุง ุจุงุฏ <code>use crate::println</code> ุฑุง ุงุณุชูุงุฏู ฺฉูู.</p>
<p>ุชุงุจุน <code>_print</code> ููุณูุฏู (<code>WRITER</code>) ุงุณุชุงุชฺฉ ูุง ุฑุง ููู ู ฺฉูุฏ ู ูุชุฏ<code>write_fmt</code> ุฑุง ุฑู ุขู ูุฑุงุฎูุงู ู ฺฉูุฏ. ุงู ูุชุฏ ุงุฒ ุชุฑุช <code>Write</code> ุงุณุช ุ ูุง ุจุงุฏ ุงู ุชุฑุช ุฑุง ูุงุฑุฏ ฺฉูู. ุงฺฏุฑ ฺุงูพ ููููุช ุขูุฒ ูุจุงุดุฏ ุ <code>unwrap()</code> ุงุถุงู ุฏุฑ ุงูุชูุง ุจุงุนุซ ูพูฺฉ ูโุดูุฏ. ุงูุง ุงุฒ ุขูุฌุง ฺฉู ูุง ููุดู <code>Ok</code> ุฑุง ุฏุฑ <code>write_str</code> ุจุฑู ฺฏุฑุฏุงูู ุ ุงู ุงุชูุงู ูู ุงูุชุฏ.</p>
<p>ุงุฒ ุขูุฌุง ฺฉู ูุงฺฉุฑููุง ุจุงุฏ ุจุชูุงููุฏ ุงุฒ ุฎุงุฑุฌ ุงุฒ ูุงฺููุ <code>_print</code> ุฑุง ูุฑุงุฎูุงู ฺฉููุฏุ ุชุงุจุน ุจุงุฏ ุนููู (public) ุจุงุดุฏ. ุจุง ุงู ุญุงู ุ ุงุฒ ุขูุฌุง ฺฉู ุงู ุฌุฒุฆุงุช ูพุงุฏู ุณุงุฒ ุฑุง ุฎุตูุต (private) ุฏุฑ ูุธุฑ ู ฺฏุฑูุ <a href="https://doc.rust-lang.org/nightly/rustdoc/write-documentation/the-doc-attribute.html#hidden">ูฺฺฏ <code>doc(hidden)</code></a> ุฑุง ุงุถุงูู ู ฺฉูู ุชุง ุงุฒ ูุณุชูุฏุงุช ุชููุฏ ุดุฏู ูพููุงู ุดูุฏ.</p>
<h3 id="hello-world-twst-println"><a class="zola-anchor" href="index.html#hello-world-twst-println" aria-label="Anchor link for: hello-world-twst-println">๐</a>Hello World ุชูุณุท <code>println</code></h3>
<p>ุงฺฉููู ู ุชูุงูู ุงุฒ <code>println</code> ุฏุฑ ุชุงุจุน <code>_start</code> ุงุณุชูุงุฏู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in src/main.rs
</span><span>
</span><span>#[no_mangle]
</span><span style="color:#569cd6;">pub extern </span><span style="color:#d69d85;">&quot;C&quot; </span><span style="color:#569cd6;">fn </span><span>_start() {
</span><span>    println!(</span><span style="color:#d69d85;">&quot;Hello World</span><span style="color:#b4cea8;">{}</span><span style="color:#d69d85;">&quot;</span><span>, </span><span style="color:#d69d85;">&quot;!&quot;</span><span>);
</span><span>
</span><span>    </span><span style="color:#569cd6;">loop </span><span>{}
</span><span>}
</span></code></pre>
<p>ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ูุง ูุฌุจูุฑ ูุณุชู ูุงฺฉุฑู ุฑุง ุฏุฑ ุชุงุจุน ุงุตู ูุงุฑุฏ ฺฉูู ุ ุฒุฑุง ุฏุฑ ุญุงู ุญุงุถุฑ ุฏุฑ ูุถุง ูุงู ุฑุดู ููุฌูุฏ ุงุณุช.</p>
<p>ููุงูุทูุฑ ฺฉู ุงูุชุธุงุฑ ู ุฑูุช ุ ุงฺฉููู ฺฉ <em>โHello World!โ</em> ุฑู ุตูุญู ูุดุงูุฏู ู ฺฉูู:</p>
<p><img src="vga-hello-world.png" alt="QEMU printing โHello World!โ" /></p>
<h3 id="chp-pym-hy-pnykh"><a class="zola-anchor" href="index.html#chp-pym-hy-pnykh" aria-label="Anchor link for: chp-pym-hy-pnykh">๐</a>ฺุงูพ ูพุงู ูุง ูพูฺฉ</h3>
<p>ุงฺฉููู ฺฉู ูุงฺฉุฑู <code>println</code> ุฑุง ุฏุงุฑู ุ ู ุชูุงูู ุงุฒ ุขู ุฏุฑ ุชุงุจุน ูพูฺฉ ุจุฑุง ฺุงูพ ูพุงู ู ูฺฉุงู ูพูฺฉ ุงุณุชูุงุฏู ฺฉูู:</p>
<pre data-lang="rust" style="background-color:#1e1e1e;color:#dcdcdc;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#608b4e;">// in main.rs
</span><span>
</span><span style="color:#608b4e;">/// This function is called on panic.
</span><span>#[panic_handler]
</span><span style="color:#569cd6;">fn </span><span>panic(info: </span><span style="color:#569cd6;">&amp;</span><span>PanicInfo) -&gt; </span><span style="color:#569cd6;">! </span><span>{
</span><span>    println!(</span><span style="color:#d69d85;">&quot;</span><span style="color:#b4cea8;">{}</span><span style="color:#d69d85;">&quot;</span><span>, info);
</span><span>    </span><span style="color:#569cd6;">loop </span><span>{}
</span><span>}
</span></code></pre>
<p>ุงฺฉููู ููุช ฺฉู <code>panic!(&quot;Some panic message&quot;);</code> ุฑุง ุฏุฑ ุชุงุจุน <code>_start</code> ุฎูุฏ ุงุถุงูู ูฺฉูู ุ ุฎุฑูุฌ ุฒุฑ ุฑุง ู ฺฏุฑู:</p>
<p><img src="vga-panic.png" alt="QEMU printing โpanicked at โSome panic messageโ, src/main.rs:28:5" /></p>
<p>ุจูุงุจุฑุงู ูุง ูู ุชููุง ูโุฏุงูู ฺฉู ฺฉ ูพูฺฉ ุฑุฎ ุฏุงุฏู ุงุณุช ุ ุจูฺฉู ูพุงู ูพูฺฉ ู ุงูฺฉู ุฏุฑ ฺฉุฌุง ฺฉุฏ ุฑุฎ ุฏุงุฏู ุงุณุช ุฑุง ูุฒ ูโุฏุงูู.</p>
<h2 id="khlsh"><a class="zola-anchor" href="index.html#khlsh" aria-label="Anchor link for: khlsh">๐</a>ุฎูุงุตู</h2>
<p>ุฏุฑ ุงู ูพุณุช ุจุง ุณุงุฎุชุงุฑ ุจุงูุฑ ูุชู VGA ู ูุญูู ููุดุชู ุขู ุงุฒ ุทุฑู ูฺฏุงุดุช ุญุงูุธู ุฏุฑ ุขุฏุฑุณ <code>0xb8000</code> ุขุดูุง ุดุฏู. ูุง ฺฉ ูุงฺูู ุฑุงุณุช ุงุฌุงุฏ ฺฉุฑุฏู ฺฉู ุนุฏู ุงููุช ููุดุชู ุฑุง ุฏุฑ ุงู ุจุงูุฑ ูฺฏุงุดุช ุญุงูุธู ุดุฏู ุฑุง ูุญุตูุฑ ู ฺฉูุฏ ู ฺฉ ุฑุงุจุท ุงูู ู ุฑุงุญุช ุจู ุฎุงุฑุฌ ุงุฑุงุฆู ู ุฏูุฏ.</p>
<p>ููฺูู ุฏุฏู ฺฉู ุจู ูุทู ฺฉุงุฑฺฏู ุ ุงุถุงูู ฺฉุฑุฏู ูุงุจุณุชฺฏ ุจู ฺฉุชุงุจุฎุงูู ูุง ุฏฺฏุฑุงู ฺูุฏุฑ ุขุณุงู ุงุณุช. ุฏู ูุงุจุณุชฺฏ ฺฉู ุงุถุงูู ฺฉุฑุฏู ุ <code>lazy_static</code> ู<code>spin</code> ุ ุฏุฑ ุชูุณุนู ุณุณุชู ุนุงูู ุจุณุงุฑ ููุฏ ูุณุชูุฏ ู ูุง ุฏุฑ ูพุณุช ูุง ุจุนุฏ ุงุฒ ุขููุง ุฏุฑ ูฺฉุงู ูุง ุจุดุชุฑ ุงุณุชูุงุฏู ุฎูุงูู ฺฉุฑุฏ.</p>
<h2 id="b-dy-chyst"><a class="zola-anchor" href="index.html#b-dy-chyst" aria-label="Anchor link for: b-dy-chyst">๐</a>ุจุนุฏ ฺุณุชุ</h2>
<p>ุฏุฑ ูพุณุช ุจุนุฏ ูุญูู ุฑุงู ุงูุฏุงุฒ ฺุงุฑฺูุจ ุชุณุช ูุงุญุฏ (Unit Test) ุฑุงุณุช ุชูุถุญ ุฏุงุฏู ุดุฏู ุงุณุช. ุณูพุณ ุงุฒ ุงู ูพุณุช ฺูุฏ ุชุณุช ูุงุญุฏ ุงุณุงุณ ุจุฑุง ูุงฺูู ุจุงูุฑ VGA ุงุฌุงุฏ ุฎูุงูู ฺฉุฑุฏ.</p>

    </div>

    <div class="post-footer-support right-to-left">
        <h2>Support Me</h2>
        
<p>
    Creating and <a href="../../status-update/index.html">maintaining</a> this blog and the associated libraries is a lot of work, but I really enjoy doing it. By supporting me, you allow me to invest more time in new content, new features, and continuous maintenance.
</p>
<p>
    The best way to support me is to <a href="https://github.com/sponsors/phil-opp"><em>sponsor me on GitHub</em></a>, since they don't charge any fees. If you prefer other platforms, I also have <a href="https://www.patreon.com/phil_opp"><em>Patreon</em></a> and <a href="https://donorbox.org/phil-opp"><em>Donorbox</em></a> accounts. The latter is the most flexible as it supports multiple currencies and one-time contributions.
</p>
<p>
    Thank you!
</p>

    </div>

    <hr>
    <div class="PageNavigation">
        
            <a class="prev" href="../minimal-rust-kernel/index.html">&laquo; ฺฉ ูุณุชู ูููุงู ุจุง Rust</a>
        
        
            <a class="next" href="../testing/index.html">ุชุณุช ฺฉุฑุฏู &raquo;</a>
        
    </div>

    <hr>
    <section>
        <h2 id="comments" class="right-to-left">ูุธุฑุงุช</h2>

        
            
            
            
        
        
    
        
        
    

    
        
        
    

    <p class="comment-note">
        Do you have a problem, want to share feedback, or discuss further ideas? Feel free to leave a comment here! Please stick to English and follow Rust's <a href="https://www.rust-lang.org/policies/code-of-conduct">code of conduct</a>. This comment thread directly maps to a <a href="https://github.com/phil-opp/blog_os/discussions/categories/post-comments-translated?discussions_q=%22VGA%20Text%20Mode%20%28fa%29%22"><em>discussion on GitHub</em></a>, so you can also comment there if you prefer.
    </p>

    <div class="giscus"></div>

    <script src="https://giscus.app/client.js"
        data-repo="phil-opp/blog_os"
        data-repo-id="MDEwOlJlcG9zaXRvcnkzOTU3NTEwMQ=="
        data-category="Post Comments (translated)"
        data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMzMDE4OTg1"
    
        data-mapping="specific"
    
        data-term="VGA Text Mode (fa)"
        data-reactions-enabled="1"
        data-emit-metadata="1"
        data-theme="preferred_color_scheme"
        data-lang="fa"
        crossorigin="anonymous"
        async>
    </script>

    <p class="comment-directly-on-github">
        Instead of authenticating the <a href="https://giscus.app">giscus</a> application, you can also comment directly <a href="https://github.com/phil-opp/blog_os/discussions/categories/post-comments-translated?discussions_q=%22VGA%20Text%20Mode%20%28fa%29%22"><em>on GitHub</em></a>.
    </p>

        <p class="right-to-left">
            ูุทูุง ูุธุฑุงุช ุฎูุฏ ุฑุง ุฏุฑ ุตูุฑุช ุงูฺฉุงู ุจู ุงูฺฏูุณ ุจููุณุฏ.
        </p>
        
    </section>

    <aside class="page-aside-right">
        <div class="block" id="language-selector">
            <h2>Other Languages</h2>
            
            <ul><li data-lang-switch-to="en" class=""><a href="../../vga-text-mode/index.html">
                        English (original)
                    </a></li><li data-lang-switch-to="zh-CN" class=""><a href="../../zh-CN/vga-text-mode/index.html">
                        Chinese (simplified)
                    </a></li><li data-lang-switch-to="ja" class=""><a href="../../ja/vga-text-mode/index.html">
                        Japanese
                    </a></li><li data-lang-switch-to="ko" class=""><a href="../../ko/vga-text-mode/index.html">
                        Korean
                    </a></li></ul>
        </div>
    </aside>

</main>
        </div>

        <div></div>

        <footer class="footer">
            <hr>
            <small>
                &copy; <time datetime="2022">2022</time>. All rights reserved.
                <a class="spaced" href="https://github.com/phil-opp/blog_os#license">License</a>
                <a class="spaced" href="../../contact/index.html">Contact</a>
            </small>
        </footer>
    </div>
</body>

</html>
